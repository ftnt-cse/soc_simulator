{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "00 - SIM Malicious URL Access",
      "description": null,
      "visible": true,
      "image": null,
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "FSM-SIM-Malicious-URL-Access",
          "aliasName": null,
          "description": "Demonstration of automated blocking of URLs",
          "collection": "/api/3/workflow_collections/f2201bf8-10f5-424b-a4d8-498e6f33750b",
          "tag": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/49fd1133-a39e-4403-ad54-ee0605202307",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "source",
                      "value": "FSMSIM-Malicious-URL-Access",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                }
              },
              "status": null,
              "left": "320",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "49fd1133-a39e-4403-ad54-ee0605202307"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Source Data",
              "description": null,
              "arguments": {
                "source_data": "{{vars.input.records[0].sourcedata}}"
              },
              "status": null,
              "left": "320",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f774e17d-b4cf-42a0-a8c1-f34900e3bf69"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Alert Attributes",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Initialize Alert Fields</span></p>",
                  "records": ""
                },
                "resource": {
                  "url": "{{vars.v_URL}}",
                  "name": "{{vars.v_Description}} - {{vars.v_Source_ID}}",
                  "type": {
                    "id": 120,
                    "@id": "/api/3/picklists/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Malware",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Malware",
                    "orderIndex": 7
                  },
                  "dueBy": "{{globalVars.Tomorrow_Date}}",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "domain": "{%if vars.v_Domain%}{{vars.v_Domain}}{%endif%}",
                  "status": {
                    "id": 118,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "reporter": "{{vars.v_Reporter}}",
                  "severity": "{{vars.v_severity}}",
                  "sourceId": "{{vars.v_Source_ID}}",
                  "sourceIp": "{{vars.v_Source_IP}}",
                  "userName": "{{vars.v_Username}}",
                  "assignedTo": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
                  "sourceType": "{{vars.v_Source_Type}}",
                  "sourcedata": "{{vars.source_data|toJSON}}",
                  "description": "{{vars.v_Description}}\nIncident Category: {{vars.v_Source_Type}}\n{%if vars.v_Source_IP%}Source IP:{{vars.v_Source_IP}}{%endif%}\n{%if vars.v_Destination_IP%}Destination IP:&nbsp;{{vars.v_Destination_IP}}{%endif%}\n{%if vars.v_Reporter %} Reporting Device: {{vars.v_Reporter}}{%endif%}{%if vars.v_Username %} Username: {{vars.v_Username}}{%endif%}",
                  "respDueDate": "{{globalVars.Tomorrow_Date}}",
                  "destinationIp": "{{vars.v_Destination_IP}}",
                  "killChainPhase": {
                    "id": 377,
                    "@id": "/api/3/picklists/d889ee08-9ddd-404b-a166-6e8c33414f5e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Delivery",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Delivery",
                    "orderIndex": 3
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "320",
              "top": "350",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "8c46da66-ac0e-4a59-bdfb-9cc0314ea980"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fields Mapping",
              "description": null,
              "arguments": {
                "v_URL": "{{vars.source_data.associated_events.0.attributes.uriStem}}",
                "v_Email": "",
                "v_Domain": "",
                "v_Metrics": "",
                "v_Service": "",
                "v_Ack_Date": "",
                "v_Reporter": "{%if vars.source_data.incident_data.attributes.incidentRptDevName%}{{vars.source_data.incident_data.attributes.incidentRptDevName}}\n{% elif vars.source_data.incident_data.attributes.reptDevIpAddr %}\n{{vars.source_data.incident_data.attributes.reptDevIpAddr}}\n{%endif%}",
                "v_Type_Map": "{'Availability/Application': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Database': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Domain Controller': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Environmental': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/FortiSIEM': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/HVAC': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Hardware': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/License': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Mail Server': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Network': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/SDN': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Server': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Storage': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Suspicious Activity': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/UPS': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Video Conferencing': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/VoIP': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/WAN': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Windows Cluster Service': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Availability/Windows File System Replication': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Change/Audit': {{\"AlertType\" | picklist(\"Compliance\")}},'Change/Policy Violation': {{\"AlertType\" | picklist(\"Policy Violation\")}},'Change/UserAccount': {{\"AlertType\" | picklist(\"Compliance\")}},'Other/Suspicious Activity': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Other/VoIP': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Application': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/CPU': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Database': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/FortiSIEM': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/IPSLA': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Interface': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Mail Server': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Memory': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Network': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/SDN': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Server': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Storage': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Storage I/O': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Storage Space': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Suspicious Activity': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/Virtualization': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Performance/VoIP': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Airline': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Application': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Audit': {{\"AlertType\" | picklist(\"Compliance\")}},'Security/Authentication': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Behavioral Anomaly': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/BotNet': {{\"AlertType\" | picklist(\"Malware\")}},'Security/Collection': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Command and Control': {{\"AlertType\" | picklist(\"Beaconing\")}},'Security/Compromised Host': {{\"AlertType\" | picklist(\"Malware\")}},'Security/Credential Access': {{\"AlertType\" | picklist(\"Lost / Stolen\")}},'Security/DDoS': {{\"AlertType\" | picklist(\"Denial of Service\")}},'Security/Defense Evasion': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Discovery': {{\"AlertType\" | picklist(\"Reconnaissance\")}},'Security/DoS': {{\"AlertType\" | picklist(\"Denial of Service\")}},'Security/Execution': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Exfiltration': {{\"AlertType\" | picklist(\"Data Exfiltration\")}},'Security/Exploit': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Impact': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Initial Access': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Lateral Movement': {{\"AlertType\" | picklist(\"Lateral Movement\")}},'Security/Malware': {{\"AlertType\" | picklist(\"Malware\")}},'Security/Network': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Persistence': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Policy Violation': {{\"AlertType\" | picklist(\"Policy Violation\")}},'Security/Privilege Escalation': {{\"AlertType\" | picklist(\"\")}},'Security/Ransomware': {{\"AlertType\" | picklist(\"Ransomware\")}},'Security/Reconnaissance': {{\"AlertType\" | picklist(\"Reconnaissance\")}},'Security/SQL Injection': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Suspicious Activity': {{\"AlertType\" | picklist(\"Other / Unknown\")}},'Security/Website defacement': {{\"AlertType\" | picklist(\"Other / Unknown\")}}}",
                "v_URL_Only": "{{vars.source_data.associated_events.0.attributes.uriStem| urlsplit('hostname')}}{{vars.source_data.associated_events.0.attributes.uriStem| urlsplit('path')|regex_replace('^(.*)/$', '\\\\1')}}",
                "v_Username": "{{vars.source_data.incident_data.attributes.user}}",
                "v_severity": "{% if vars.source_data.incident_data.attributes.eventSeverityCat == \"LOW\" %}{{\"Severity\" | picklist(\"Low\", \"@id\")}}{% elif vars.source_data.incident_data.attributes.eventSeverityCat == \"MEDIUM\" %}{{\"Severity\" | picklist(\"Medium\", \"@id\")}}{% elif vars.source_data.incident_data.attributes.eventSeverityCat == \"HIGH\" %}{{\"Severity\" | picklist(\"High\", \"@id\")}}{%endif%}",
                "v_File_Hash": "",
                "v_File_Name": "{{vars.source_data.associated_events.0.attributes.fileName}}",
                "v_File_Path": "",
                "v_Source_ID": "{{vars.source_data.incident_data.nid}}",
                "v_Source_IP": "{{vars.source_data.associated_events.0.attributes.srcIpAddr}}",
                "v_eventName": "{{vars.source_data.associated_events.0.attributes.eventName}}",
                "v_Device_UID": "",
                "v_Email_Body": "",
                "v_Email_From": "",
                "v_Epoch_Time": "",
                "v_Event_Time": "{{vars.source_data.incident_data.attributes.phRecvTime}}",
                "v_File_Names": "",
                "v_Process_ID": "",
                "v_Description": "{{vars.source_data.incident_data.attributes.incidentTitle}}",
                "v_Return_Path": "",
                "v_Source_Port": "",
                "v_Source_Tool": "",
                "v_Source_Type": "{{vars.source_data.incident_data.attributes.eventType}}",
                "v_incidentSrc": "",
                "v_Command_Line": "",
                "v_Latest_Login": "",
                "v_Process_GUID": "",
                "v_Process_Name": "",
                "v_Process_Tree": "",
                "v_Registry_Key": "",
                "v_Response_SLA": "",
                "v_Target_Asset": "",
                "v_dlp_dlpextra": "{%if 'dlpextra' in  vars.source_data.associated_events.0.attributes.rawEventMsg%}{{(vars.source_data.associated_events.0.attributes.rawEventMsg|regex_search(\"dlpextra=([^\\s]*)\")).split('\"')[1]}}{%endif%}",
                "v_Computer_Name": "{%if vars.incidentCategory =='Change/UserAccount'%}{{vars.origDevName}}{%endif%}",
                "v_Email_Headers": "",
                "v_Email_Subject": "",
                "v_Sender_Domain": "",
                "v_Destination_IP": "{{vars.source_data.associated_events.0.attributes.destIpAddr}}",
                "v_Scheduled_Task": "",
                "v_Source_Process": "",
                "v_Target_Process": "",
                "v_incidentTarget": "{%if vars.incidentTarget%}{{vars.incidentTarget | extract_artifacts}}{%endif%}",
                "v_Attachment_Names": "",
                "v_Destination_Port": "{{vars.source_data.associated_events.0.attributes.destIpPort}}",
                "v_Bytes_Transferred": "",
                "v_Escalation_Reason": "",
                "v_Parent_Process_ID": "",
                "v_Registry_Key_Value": "",
                "v_Allow_List_Location": "/var/www/html/allowed-urls.txt",
                "v_Block_List_Location": "/var/www/html/blocked-urls.txt",
                "v_Email_Recipients_To": "",
                "v_Parent_Process_Name": "",
                "v_Reporter_Email_Body": "",
                "v_Decoded_Command_Line": "",
                "v_Sender_Email_Address": "",
                "v_Recipient_Email_Address": "",
                "v_Parent_Process_Command_Line": ""
              },
              "status": null,
              "left": "320",
              "top": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "0b5ae245-eda6-49b2-a26d-b34660d84dc4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is URL Known",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/d941fbb8-f9c6-4f3e-bde0-e0990a8eb8a2"
                  },
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/0191a4bb-c832-437d-8f8a-85eeb3bdd549",
                    "condition": "{{ (vars.v_URL_Only in vars.v_Blocked_URLs) or (vars.v_URL_Only in vars.v_Allowed_URLs) }}"
                  }
                ]
              },
              "status": null,
              "left": "320",
              "top": "680",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "b3aa435b-a745-435c-b41d-e1fdfb7cc6df"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Local URLs Blacklist",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "f2551884-049e-4dff-8418-1c39442e43e4",
                "params": {
                  "cmd": "cat {{vars.v_Block_List_Location}}",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Obtaining FortiGate's Current Block List</span></p>",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "operationTitle": "Execute remote command",
                "step_variables": {
                  "v_Blocked_URLs": "{{vars.result.data.split(\"\\r\\n\")}}"
                }
              },
              "status": null,
              "left": "28",
              "top": "574",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "d3f108c8-0b52-4212-97a6-60d602fbf645"
            },
            {
              "@type": "WorkflowStep",
              "name": "IS URL in Blocked URL List",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "URL already in block list",
                    "step_iri": "/api/3/workflow_steps/bfea228f-949f-4f99-bfe7-658977e86e2b",
                    "condition": "{{ vars.v_URL_Only in vars.v_Blocked_URLs }}"
                  }
                ]
              },
              "status": null,
              "left": "3406",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "107e3a9b-e576-49ad-b4a4-f30cf91803dc"
            },
            {
              "@type": "WorkflowStep",
              "name": "URL is Already in List",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<span style=\"background-color:yellow;color:black;font-weight:bold\">Automatic closure of alert</span>\n\nURL <span style=\"color:red;font-weight:bold\">{{vars.v_URL}}</span> was already in the FortiGate's block list and so no further action was necessary.",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 120,
                    "@id": "/api/3/picklists/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Malware",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Malware",
                    "orderIndex": 7
                  },
                  "state": {
                    "id": 221,
                    "@id": "/api/3/picklists/2879663c-c1dc-4ef2-84ae-8c67c9353b86",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Detail Extracted",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "Detail Extracted",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 246,
                    "@id": "/api/3/picklists/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Closed",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Closed",
                    "orderIndex": 4
                  },
                  "respDate": "{{globalVars.Current_Date}}",
                  "severity": {
                    "id": 12,
                    "@id": "/api/3/picklists/0d609b08-45e0-469f-8910-41145c0b7c03",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#157DD9",
                    "display": "Minimal",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Minimal",
                    "orderIndex": 0
                  },
                  "closureNotes": "At the time of closure the URL <span style=\"color:red;font-weight:bold\">{{vars.v_URL}}</span> was already in the FortiGate's block list and so no further action was necessary.\n\nThe alert was closed automatically.",
                  "resolveddate": "{{globalVars.Current_Date}}",
                  "closureReason": {
                    "id": 249,
                    "@id": "/api/3/picklists/672aef13-a684-422e-be6c-15e10ec49915",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Duplicate",
                    "listName": "/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                    "itemValue": "Duplicate",
                    "orderIndex": 1
                  },
                  "killChainPhase": {
                    "id": 377,
                    "@id": "/api/3/picklists/d889ee08-9ddd-404b-a166-6e8c33414f5e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Delivery",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Delivery",
                    "orderIndex": 3
                  },
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "3406",
              "top": "193",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "bfea228f-949f-4f99-bfe7-658977e86e2b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get URL Rating from VirusTotal",
              "description": null,
              "arguments": {
                "name": "VirusTotal",
                "config": "8600f9cc-b2b7-4626-8e6e-f7adba40c1d6",
                "params": {
                  "url": "{{vars.v_URL}}"
                },
                "version": "1.0.1",
                "connector": "virustotal",
                "operation": "scan_url",
                "operationTitle": "Submit URL for scanning",
                "step_variables": {
                  "v_VT_Positives": "{{vars.result.data.positives}}",
                  "v_VT_Total_Result": "{{vars.result.data.total}}"
                }
              },
              "status": null,
              "left": "646",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2a37459d-9293-4196-b1f9-f1928a318dc1"
            },
            {
              "@type": "WorkflowStep",
              "name": "is URL Malicious",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/8aacc8fa-ac83-4f75-857c-478c17f0f6f5",
                    "condition": "{{ vars.score_average > 0 }}"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/87aa2fd2-ebb4-46e9-abde-212e1d6bcb48"
                  }
                ]
              },
              "status": null,
              "left": "1100",
              "top": "360",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "9dcb8d9d-9b12-4c11-86f5-456f5f063b51"
            },
            {
              "@type": "WorkflowStep",
              "name": "Close Alert as Automatic URL Blocked",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Automatic closure of alert</span></p>\n\n<p>The malicious URL <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ {{vars.v_URL}} ]</span> was added to FortiGate block list. This was decided <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\"> [ Automatically ]</span> due to the URL rating from VirusTotal and IBM XForce, and the alert was closed due to no further actions being required.</p>",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 254,
                    "@id": "/api/3/picklists/8e6e8d5a-5c9e-42f8-852f-a41258d0454f",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Firewall Configuration Change",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Firewall Configuration Change",
                    "orderIndex": 9
                  },
                  "state": {
                    "id": 221,
                    "@id": "/api/3/picklists/2879663c-c1dc-4ef2-84ae-8c67c9353b86",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Detail Extracted",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "Detail Extracted",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 246,
                    "@id": "/api/3/picklists/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Closed",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Closed",
                    "orderIndex": 4
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "respDate": "{{globalVars.Current_Date}}",
                  "severity": {
                    "id": 119,
                    "@id": "/api/3/picklists/7efa2220-39bb-44e4-961f-ac368776e3b0",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#e31b1d",
                    "display": "Critical",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Critical",
                    "orderIndex": 4
                  },
                  "ackSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "closureNotes": "<p>At the time of closure the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was not rated by FortiGuard nor was it in the FortiGate's block list. The URL had an aggregate rating of <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ {{vars.v_VT_Aggregate_Score}} ]</span> out of 100, and <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[  {{vars.v_VT_Positives}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_VT_Total_Result}} ]</span> detected it as malicious.</p>\n\n<p>IBM XForce gave this a score {% if vars.v_XForce_Score == 0 %}<span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">{% else %}<span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">{%endif%}[ {{vars.v_XForce_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 10 ]</span>.</p>\n\n<p>The URL was added to FortiGate block list. This was decided by <span style=\"background-color:#1E6E23;color:white;font-weight:bold\"> [ Automatically ]</span> due to the URL rating from VirusTotal and IBM XForce. This automatically closed the alert.</p>",
                  "resolveddate": "{{globalVars.Current_Date}}",
                  "closureReason": {
                    "id": 251,
                    "@id": "/api/3/picklists/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Tasks Completed",
                    "listName": "/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                    "itemValue": "Tasks Completed",
                    "orderIndex": 0
                  },
                  "respSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "killChainPhase": {
                    "id": 377,
                    "@id": "/api/3/picklists/d889ee08-9ddd-404b-a166-6e8c33414f5e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Delivery",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Delivery",
                    "orderIndex": 3
                  },
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "900",
              "top": "754",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "5454ff14-8487-4687-94ce-d8992ab1eec7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Prompt Whether to Block URL",
              "description": null,
              "arguments": {
                "type": "DecisionBased",
                "input": {
                  "schema": {
                    "title": "Should the URL be blocked?",
                    "description": "<p>URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> is currently not categorised by the FortiGate. At this time VirusTotal has given this URL an aggregate rating of {% if vars.v_VT_Aggregate_Score == 0 %}<span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">{% else %}<span style=\"background-color:#e31b1d;color:#FFF;font-weight:bold\">{%endif%}[ {{vars.v_VT_Aggregate_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 100 ]</span>, and {% if vars.v_VT_Positives == 0 %}<span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">{% else %}<span style=\"background-color:#e31b1d;color:#FFF;font-weight:bold\">{%endif%}[ {{vars.v_VT_Positives}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_VT_Total_Result}} ]</span> have detected the URL as malicious.</p>\n<br>\n<p>IBM XForce has given this a score {% if vars.v_XForce_Score == 0 %}<span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">{% else %}<span style=\"background-color:#e31b1d;color:#FFF;font-weight:bold\">{%endif%}[ {{vars.v_XForce_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 10 ]</span>.</p>\n<br>\n<p>Should the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> be added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block List ]</span> or <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ Allow List ]</span>?</p>",
                    "inputVariables": []
                  }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Block List",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/044a8a3d-373c-4f69-9a0e-16394dbdfaf7"
                    },
                    {
                      "option": "Allow List",
                      "step_iri": "/api/3/workflow_steps/d5c93483-5983-47c2-9fd8-f94ef9d232f0"
                    }
                  ],
                  "duplicateOption": false
                }
              },
              "status": null,
              "left": "1260",
              "top": "570",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "6ce11c76-dd60-4566-83db-5b92c79fea17"
            },
            {
              "@type": "WorkflowStep",
              "name": "Close Alert as URL Allowed",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Automatic closure of alert</span></p>\n\n<p>The URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was added to FortiGate's <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ Allow ]</span> list.</p>\n<br>\n<p>This was decided by <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.input.records.0.createUser.firstname}} {{vars.input.records.0.createUser.lastname}} ]</span>.</p>\n<br>\n<p>The alert was then automatically closed.</p>",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 254,
                    "@id": "/api/3/picklists/8e6e8d5a-5c9e-42f8-852f-a41258d0454f",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Firewall Configuration Change",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Firewall Configuration Change",
                    "orderIndex": 9
                  },
                  "state": {
                    "id": 221,
                    "@id": "/api/3/picklists/2879663c-c1dc-4ef2-84ae-8c67c9353b86",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Detail Extracted",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "Detail Extracted",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 246,
                    "@id": "/api/3/picklists/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Closed",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Closed",
                    "orderIndex": 4
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "respDate": "{{globalVars.Current_Date}}",
                  "severity": {
                    "id": 83,
                    "@id": "/api/3/picklists/58d0753f-f7e4-403b-953c-b0f521eab759",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#28B35C",
                    "display": "Low",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Low",
                    "orderIndex": 1
                  },
                  "ackSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "closureNotes": "<p>At the time of closure the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was not rated by FortiGuard nor was it in the FortiGate's block or allow lists. The URL had an aggregate rating of <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.v_VT_Aggregate_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 100 ]</span>, and <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[  {{vars.v_VT_Positives}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_VT_Total_Result}} ]</span> detected it as malicious.</p>\n\n<p>IBM XForce gave this a score <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.v_XForce_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 10 ]</span>.</p>\n\n<p>The URL was added to FortiGate's <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ Allow ]</span> list. This was decided by <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.input.records.0.createUser.firstname}} {{vars.input.records.0.createUser.lastname}} ]</span>. This automatically closed the alert.</p>",
                  "resolveddate": "{{globalVars.Current_Date}}",
                  "closureReason": {
                    "id": 250,
                    "@id": "/api/3/picklists/2b0112f6-4746-4dab-ada6-a8cd1e675572",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "False Positive",
                    "listName": "/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                    "itemValue": "False Positive",
                    "orderIndex": 2
                  },
                  "respSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "killChainPhase": {
                    "id": 377,
                    "@id": "/api/3/picklists/d889ee08-9ddd-404b-a166-6e8c33414f5e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Delivery",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Delivery",
                    "orderIndex": 3
                  },
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "1620",
              "top": "940",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "f51eeefe-a953-463d-a8ed-927703186248"
            },
            {
              "@type": "WorkflowStep",
              "name": "User Requested URL Block",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "f2551884-049e-4dff-8418-1c39442e43e4",
                "params": {
                  "cmd": "echo \"{{vars.v_URL_Only}}\" >> {{vars.v_Block_List_Location}}",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<span style=\"background-color:yellow;color:black;font-weight:bold\">Adding URL to FortiGate's Block List</span>\n\nURL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\"> [ {{vars.v_URL_Only}} ]</span> has now been added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span> list.",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "operationTitle": "Execute remote command",
                "step_variables": []
              },
              "status": null,
              "left": "1260",
              "top": "700",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "044a8a3d-373c-4f69-9a0e-16394dbdfaf7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Close Alert as URL Blocked Manually",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Automatic closure of alert</span></p>\n\n<p>URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span> list. This was decided by <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.input.records.0.createUser.firstname}} {{vars.input.records.0.createUser.lastname}} ]</span>.</p>\n<br>\n<p>The alert was then automatically closed.</p>",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 254,
                    "@id": "/api/3/picklists/8e6e8d5a-5c9e-42f8-852f-a41258d0454f",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Firewall Configuration Change",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Firewall Configuration Change",
                    "orderIndex": 9
                  },
                  "state": {
                    "id": 221,
                    "@id": "/api/3/picklists/2879663c-c1dc-4ef2-84ae-8c67c9353b86",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Detail Extracted",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "Detail Extracted",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 246,
                    "@id": "/api/3/picklists/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Closed",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Closed",
                    "orderIndex": 4
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "respDate": "{{globalVars.Current_Date}}",
                  "severity": {
                    "id": 119,
                    "@id": "/api/3/picklists/7efa2220-39bb-44e4-961f-ac368776e3b0",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#e31b1d",
                    "display": "Critical",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Critical",
                    "orderIndex": 4
                  },
                  "ackSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "closureNotes": "<p>At the time of closure the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was not rated by FortiGuard nor was it in the FortiGate's block list. The URL had an aggregate rating of <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.v_VT_Aggregate_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 100 ]</span>, and <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[  {{vars.v_VT_Positives}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_VT_Total_Result}} ]</span> detected it as malicious.</p>\n\n<p>IBM XForce gave this a score <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.v_XForce_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 10 ]</span>.</p>\n\n<p>The URL was added to FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span> list. This was decided by <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ {{vars.input.records.0.createUser.firstname}} {{vars.input.records.0.createUser.lastname}} ]</span>. This automatically closed the alert.</p>",
                  "resolveddate": "{{globalVars.Current_Date}}",
                  "closureReason": {
                    "id": 251,
                    "@id": "/api/3/picklists/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Tasks Completed",
                    "listName": "/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                    "itemValue": "Tasks Completed",
                    "orderIndex": 0
                  },
                  "respSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "killChainPhase": {
                    "id": 377,
                    "@id": "/api/3/picklists/d889ee08-9ddd-404b-a166-6e8c33414f5e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Delivery",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Delivery",
                    "orderIndex": 3
                  },
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "1260",
              "top": "940",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "bbc14413-838f-4a25-bdd9-d5a8a1f4f3dc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Indicator",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.v_URL}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "indicators?$limit=30",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Find Indicator</span></p>\n\n<p>Checking if URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> already exists as an indicator.</p>",
                  "records": ""
                },
                "step_variables": []
              },
              "status": null,
              "left": "320",
              "top": "460",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "899b4e94-b5e6-4a15-9ec2-0aae7f66d1fb"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get URL Reputation",
              "description": null,
              "arguments": {
                "v_XForce_Score": "0",
                "v_XForce_Categories": "Unrated",
                "v_XForce_Category_Descriptions": "This site is unrated."
              },
              "status": null,
              "left": "646",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "d941fbb8-f9c6-4f3e-bde0-e0990a8eb8a2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create URL Indicator",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Find_Indicator | length == 0}}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Creating New URL Indicator</span></p>\n\n<p>URL already exists in the {% if vars.v_URL_Only in vars.v_Blocked_URLs %}<span style=\"background-color:#e31b1d;color:#FFF;font-weight:bold\">[ Block ]</span>{% elif vars.v_URL_Only in vars.v_Allowed_URLs %}<span style=\"background-color:#1e6e23;color:white;font-weight:bold\">[ Allow ]</span>{%endif%} list, but did not exist as a URL indicator.</p>\n\n<p>Creating a new URL indciator for <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span>.</p>",
                  "records": ""
                },
                "resource": {
                  "value": "{{vars.v_URL}}",
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "sources": "blocklist",
                  "lastSeen": "{{globalVars.Current_Date}}",
                  "__replace": "",
                  "firstSeen": "{{globalVars.Current_Date}}",
                  "reputation": "{% if vars.v_URL_Only in vars.v_Blocked_URLs %}{{\"IndicatorReputation\" | picklist(\"Malicious\", \"@id\")}}{% elif vars.v_URL_Only in vars.v_Allowed_URLs %}{{\"IndicatorReputation\" | picklist(\"Good\", \"@id\")}}{%endif%}",
                  "description": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">URL In local Blocklist</span></p>\n\n<p>URL already exists in the {% if vars.v_URL_Only in vars.v_Blocked_URLs %}<span style=\"background-color:#e31b1d;color:#FFF;font-weight:bold\">[ Block ]</span>{% elif vars.v_URL_Only in vars.v_Allowed_URLs %}<span style=\"background-color:#1e6e23;color:white;font-weight:bold\">[ Allow ]</span>{%endif%} list, but did not exist as a URL indicator.</p>",
                  "indicatorStatus": "{% if vars.v_URL_Only in vars.v_Blocked_URLs %}{{\"IndicatorStatus\" | picklist(\"Blocked\", \"@id\")}}{% elif vars.v_URL_Only in vars.v_Allowed_URLs %}{{\"IndicatorStatus\" | picklist(\"Whitelisted\", \"@id\")}}{%endif%}",
                  "typeofindicator": {
                    "id": 80,
                    "@id": "/api/3/picklists/353a37b4-3eeb-43ee-aac6-64806422cfec",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "URL",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "URL",
                    "orderIndex": 10
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "320",
              "top": "793",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "0191a4bb-c832-437d-8f8a-85eeb3bdd549"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Alert with Existing Indicator",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Automatic closure of alert</span></p>\n\n<p>At the time of closure the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was already located in the FortiGate's {% if vars.v_URL_Only in vars.v_Blocked_URLs %}<span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span>{% elif vars.v_URL_Only in vars.v_Allowed_URLs %}<span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ Allow ]</span>{%endif%} list.</p>\n<br>\n<p>The {% if vars.steps.Find_Indicator | length == 0 %}new{% else %}existing{%endif%} URL indicator was attached to the alert.</p>\n\n\n\n\n\n\n",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 120,
                    "@id": "/api/3/picklists/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Malware",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Malware",
                    "orderIndex": 7
                  },
                  "state": {
                    "id": 221,
                    "@id": "/api/3/picklists/2879663c-c1dc-4ef2-84ae-8c67c9353b86",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Detail Extracted",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "Detail Extracted",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 246,
                    "@id": "/api/3/picklists/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Closed",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Closed",
                    "orderIndex": 4
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "respDate": "{{globalVars.Current_Date}}",
                  "severity": "{% if vars.v_URL_Only in vars.v_Allowed_URLs %}{{\"Severity\" | picklist(\"Minimal\", \"@id\")}}{% else %}{{\"Severity\" | picklist(\"Medium\", \"@id\")}}{%endif%}",
                  "indicators": "{%if vars.steps.Find_Indicator | length != 0 %}{{vars.steps.Find_Indicator[0]['@id']}}{%endif%}",
                  "ackSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "closureNotes": "<p>At the time of closure the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was already located in the FortiGate's {% if vars.v_URL_Only in vars.v_Blocked_URLs %}<span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block List ]</span>{% elif vars.v_URL_Only in vars.v_Allowed_URLs %}<span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ Allow list ]</span>{%endif%}.</p>",
                  "resolveddate": "{{globalVars.Current_Date}}",
                  "closureReason": {
                    "id": 249,
                    "@id": "/api/3/picklists/672aef13-a684-422e-be6c-15e10ec49915",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Duplicate",
                    "listName": "/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                    "itemValue": "Duplicate",
                    "orderIndex": 1
                  },
                  "respSlaStatus": "{% if globalVars.Current_Date <= vars.steps.Update_Alert_Attributes.respDueDate %}{{\"SLAState\" | picklist(\"Met\", \"@id\")}}{% else %}{{\"SLAState\" | picklist(\"Missed\", \"@id\")}}{% endif %}",
                  "killChainPhase": {
                    "id": 377,
                    "@id": "/api/3/picklists/d889ee08-9ddd-404b-a166-6e8c33414f5e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Delivery",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Delivery",
                    "orderIndex": 3
                  },
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "320",
              "top": "900",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "40020287-b79d-4915-bbb9-aa4f97e59496"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Local URLs Whitelist",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "8ffbff18-2d9f-42f1-8c87-dc6f2c37da08",
                "params": {
                  "cmd": "cat {{vars.v_Allow_List_Location}}",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Obtaining FortiGate's Current Allow List</span></p>",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "operationTitle": "Execute remote command",
                "step_variables": {
                  "v_Allowed_URLs": "{{vars.result.data.split(\"\\r\\n\")}}"
                }
              },
              "status": null,
              "left": "320",
              "top": "574",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "d4896833-9e95-4e6a-835c-55187c452ccc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get URL Rating from IBM XForce",
              "description": null,
              "arguments": {
                "name": "IBM XForce",
                "config": "ce3f1464-294d-44fa-8b64-e1f8e55761f1",
                "params": {
                  "url": "{{vars.v_URL}}"
                },
                "version": "1.0.1",
                "connector": "xforce",
                "operation": "get_url_report",
                "ignore_errors": true,
                "operationTitle": "Get URL Report",
                "step_variables": {
                  "v_XForce_Score": "{{vars.result.data.result.score}}",
                  "v_XForce_Categories": "{{vars.result.data.result.cats}}",
                  "v_XForce_Category_Descriptions": "{{vars.result.data.result.categoryDescriptions}}"
                }
              },
              "status": null,
              "left": "646",
              "top": "246",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3a1efbc9-56c5-43ae-830d-e0858e7731ec"
            },
            {
              "@type": "WorkflowStep",
              "name": "User Requested URL Allow",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "8ffbff18-2d9f-42f1-8c87-dc6f2c37da08",
                "params": {
                  "cmd": "echo \"{{vars.v_URL_Only}}\" >> {{vars.v_Allow_List_Location}}",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Adding URL to FortiGate's Allow List</span></p>\n\n<p>The URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL_Only}} ]</span> has now been added to the FortiGate's <span style=\"background-color:#1E6E23;color:white;font-weight:bold\"> [ Allow ]</span> list.</p>",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "operationTitle": "Execute remote command",
                "step_variables": []
              },
              "status": null,
              "left": "1620",
              "top": "700",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "d5c93483-5983-47c2-9fd8-f94ef9d232f0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create URL Indicator When Rated and Not Known",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Find_Indicator | length == 0}}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Creating New URL Indicator</span></p>\n\n<p>A new URL indicator has been created for <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> with a reputation of <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Malicious ]</span>.</p>",
                  "records": ""
                },
                "resource": {
                  "value": "{{vars.v_URL}}",
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "sources": "blocklist",
                  "lastSeen": "{{globalVars.Current_Date}}",
                  "__replace": "",
                  "firstSeen": "{{globalVars.Current_Date}}",
                  "reputation": {
                    "id": 109,
                    "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#c42323",
                    "display": "Malicious",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Malicious",
                    "orderIndex": 1
                  },
                  "description": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">URL In Block List</span></p>\n\n<p>The URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span> list. This was decided <span style=\"background-color:#1E6E23;color:white;font-weight:bold\">[ automatically ]</span> due to the URL ratings from VirusTotal and IBM XForce.</p>",
                  "indicatorStatus": {
                    "id": 366,
                    "@id": "/api/3/picklists/fa29fe48-f01e-476f-bb33-c910f5795b57",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Blocked",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "Blocked",
                    "orderIndex": 0
                  },
                  "typeofindicator": {
                    "id": 80,
                    "@id": "/api/3/picklists/353a37b4-3eeb-43ee-aac6-64806422cfec",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "URL",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "URL",
                    "orderIndex": 10
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "900",
              "top": "654",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "e3dd0e4f-59e9-4a13-858b-d8ff5fad8143"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create URL Indicator When Unrated and Blocked",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Find_Indicator | length == 0}}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<span style=\"background-color:yellow;color:black;font-weight:bold\">Creating New URL Indicator</span>\n\nA new URL indicator has been created for <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> with a reputation of <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Malicious ]</span>.",
                  "records": ""
                },
                "resource": {
                  "value": "{{vars.v_URL}}",
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "sources": "blocklist",
                  "lastSeen": "{{globalVars.Current_Date}}",
                  "__replace": "",
                  "firstSeen": "{{globalVars.Current_Date}}",
                  "reputation": {
                    "id": 109,
                    "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#c42323",
                    "display": "Malicious",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Malicious",
                    "orderIndex": 1
                  },
                  "description": "<span style=\"background-color:yellow;color:black;font-weight:bold\">URL In Block List</span>\n\nThe URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span> list. This was decided by <span style=\"background-color:#1E6E23;color:white;font-weight:bold\"> [ {{vars.input.records.0.createUser.firstname}} {{vars.input.records.0.createUser.lastname}} ]</span>.",
                  "indicatorStatus": {
                    "id": 366,
                    "@id": "/api/3/picklists/fa29fe48-f01e-476f-bb33-c910f5795b57",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Blocked",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "Blocked",
                    "orderIndex": 0
                  },
                  "typeofindicator": {
                    "id": 80,
                    "@id": "/api/3/picklists/353a37b4-3eeb-43ee-aac6-64806422cfec",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "URL",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "URL",
                    "orderIndex": 10
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "1260",
              "top": "820",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "31ec48a5-f38a-459c-96ec-c912821887cf"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create URL Indicator When Unrated and Allowed",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Find_Indicator | length == 0}}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<span style=\"background-color:yellow;color:black;font-weight:bold\">Creating New URL Indicator</span>\n\nA new URL indicator has been created for <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> with a reputation of <span style=\"background-color:#1E6E23;color:white;font-weight:bold\">[ Good ]</span>.",
                  "records": ""
                },
                "resource": {
                  "value": "{{vars.v_URL}}",
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "sources": "whitelist",
                  "__replace": "",
                  "reputation": {
                    "id": 149,
                    "@id": "/api/3/picklists/9a611980-1b5e-4ae9-8062-eb2c0c433cff",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#6a9169",
                    "display": "No Reputation Available",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "No Reputation Available",
                    "orderIndex": 4
                  },
                  "description": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">URL In Allow List</span></p>\n\n<p>The URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> was added to the FortiGate's <span style=\"background-color:#1E6E23;color:white;font-weight:bold\">[ Allow ]</span> list.</p>\n\n<p>This was decided by <span style=\"background-color:#1E6E23;color:white;font-weight:bold\">[ {{vars.input.records.0.createUser.firstname}} {{vars.input.records.0.createUser.lastname}} ]</span>.</p>",
                  "indicatorStatus": {
                    "id": 368,
                    "@id": "/api/3/picklists/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Whitelisted",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "Whitelisted",
                    "orderIndex": 2
                  },
                  "typeofindicator": {
                    "id": 80,
                    "@id": "/api/3/picklists/353a37b4-3eeb-43ee-aac6-64806422cfec",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "URL",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "URL",
                    "orderIndex": 10
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "1620",
              "top": "820",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "4ec68cfa-67a4-4b06-8fda-30f4c97047d0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get XForce URL Reputation",
              "description": null,
              "arguments": {
                "v_XForce_Score_Aggregate": "{%if (not vars.v_XForce_Score|int)%}0{%else%}\n{{(vars.v_XForce_Score * 10)}}{%endif%}"
              },
              "status": null,
              "left": "646",
              "top": "349",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "89b380f6-24ca-4654-bd08-2c9ddaf3b524"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Average Score",
              "description": null,
              "arguments": {
                "score_average": "{{(vars.v_XForce_Score_Aggregate + vars.v_VT_Aggregate_Score)/2}}"
              },
              "status": null,
              "left": "1100",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "a66ad14c-5f35-4a04-bb9d-8a9675c29ea9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get VT Reputation",
              "description": null,
              "arguments": {
                "v_VT_Aggregate_Score": "{{vars.steps.Get_URL_Rating_from_VirusTotal.data.aggregate}}"
              },
              "status": null,
              "left": "1500",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "97a41571-919c-46e4-a79e-e8e1720c543c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Automatic URL Block",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "f2551884-049e-4dff-8418-1c39442e43e4",
                "params": {
                  "cmd": "echo \"{{vars.v_URL_Only}}\" >> {{vars.v_Block_List_Location}}",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Adding URL to FortiGate's Block List</span></p>\n\n<p>The malicious URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL_Only}} ]</span> has now been added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block ]</span> list.</p>",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "operationTitle": "Execute remote command",
                "step_variables": []
              },
              "status": null,
              "left": "900",
              "top": "554",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "41ab5959-3d25-4029-8e2e-78179f250dee"
            },
            {
              "@type": "WorkflowStep",
              "name": "Manual Decision Required",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Manual Decision Required</span></p>\n\n<p>Due to the rating of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 0 ]</span> from both VirusTotal and IBM XForce, a manual decision is required whether the URL <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_URL}} ]</span> should be added to the FortiGate's <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Block List ]</span> or <span style=\"background-color:#1E6E23;color:#FFF;font-weight:bold\">[ Allow List ]</span>.</p>",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 120,
                    "@id": "/api/3/picklists/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Malware",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Malware",
                    "orderIndex": 7
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/comments",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "1260",
              "top": "460",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "87aa2fd2-ebb4-46e9-abde-212e1d6bcb48"
            },
            {
              "@type": "WorkflowStep",
              "name": "Automatic Blocking Of URL",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">Automated Block Deciscion</span></p>\n\n<p>Due to the combined rating of <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ {{vars.score_average}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 100 ]</span> from VirusTotal and IBM XForce, it was automatically determined that this URL is <span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">[ Malicious ]</span> and it should be blocked.</p>",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 120,
                    "@id": "/api/3/picklists/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Malware",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Malware",
                    "orderIndex": 7
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/comments",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "900",
              "top": "460",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "8aacc8fa-ac83-4f75-857c-478c17f0f6f5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Report XForce URL Reputation",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">IBM XForce URL Lookup</span></p>\n\n<p>The score for the URL from IBM XForce was {%if (not vars.v_XForce_Score|int)%}<span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 0 ]{%else%}<span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\"> [ {{vars.v_XForce_Score}} ]{%endif%}</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ 10 ]</span>.</p>",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 120,
                    "@id": "/api/3/picklists/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Malware",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Malware",
                    "orderIndex": 7
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "940",
              "top": "247",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "83821d59-6680-4b65-853a-503e1d633dd5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set VT Reputation",
              "description": null,
              "arguments": {
                "v_VT_Positives": "{%if not vars.steps.Get_URL_Rating_from_VirusTotal.data.positives%}0{%else%}{{vars.steps.Get_URL_Rating_from_VirusTotal.data.positives}}{%endif%}",
                "v_VT_Total_Result": "{%if not vars.steps.Get_URL_Rating_from_VirusTotal.data.total%}67{%else%}{{vars.steps.Get_URL_Rating_from_VirusTotal.data.total}}{%endif%}"
              },
              "status": null,
              "left": "1100",
              "top": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7e8ac904-01dc-4bbd-8bd6-58df57682c49"
            },
            {
              "@type": "WorkflowStep",
              "name": "Add Url Rating",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "<p><span style=\"background-color:yellow;color:black;font-weight:bold\">VirusTotal URL Lookup</span></p>\n\n<p>VirusTotal identified that {% if vars.v_VT_Positives == 0 %}<span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">{% else %}<span style=\"background-color:#e31b1d;color:#FFF;font-weight:bold\">{%endif%}[ {{vars.v_VT_Positives}} ]</span> of it's <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">[ {{vars.v_VT_Total_Result}} ]</span> identified the URL as potentially malicious.</p>\n<br>\n<p>The aggregate score was {% if vars.v_VT_Aggregate_Score == 0 %}<span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">{% else %}<span style=\"background-color:#E31B1D;color:#FFF;font-weight:bold\">{%endif%}[ {{vars.v_VT_Aggregate_Score}} ]</span> out of <span style=\"background-color:#E4DBCF;color:#1B2430;font-weight:bold\">100</span>.</p>",
                  "records": ""
                },
                "resource": {
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "__replace": ""
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "1500",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "708da227-6c9e-4c35-90f8-115acc8eef09"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "b95e38f9-ae90-477e-9ab1-5c4aa67b3ce7",
              "name": "Start -> Set Source Data",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/f774e17d-b4cf-42a0-a8c1-f34900e3bf69",
              "sourceStep": "/api/3/workflow_steps/49fd1133-a39e-4403-ad54-ee0605202307"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "ff4128ad-18eb-48c6-a1d6-1e3b053ba37e",
              "name": "Set Source Data -> Fields Mapping",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/0b5ae245-eda6-49b2-a26d-b34660d84dc4",
              "sourceStep": "/api/3/workflow_steps/f774e17d-b4cf-42a0-a8c1-f34900e3bf69"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "b143ac9c-7390-41d8-a877-5ed04aeba0ad",
              "name": "IS URL in Blocked URL List -> URL is Already in List",
              "label": "URL already in block list",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/bfea228f-949f-4f99-bfe7-658977e86e2b",
              "sourceStep": "/api/3/workflow_steps/107e3a9b-e576-49ad-b4a4-f30cf91803dc"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "626e9f69-b8f6-48f1-8ba8-f0beedf58fb8",
              "name": "Get Local URLs Blacklist -> Is URL Known",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/b3aa435b-a745-435c-b41d-e1fdfb7cc6df",
              "sourceStep": "/api/3/workflow_steps/d3f108c8-0b52-4212-97a6-60d602fbf645"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "cdfca560-91ff-4410-aa86-234507423956",
              "name": "Is URL Known -> Get URL Reputation",
              "label": "No",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/d941fbb8-f9c6-4f3e-bde0-e0990a8eb8a2",
              "sourceStep": "/api/3/workflow_steps/b3aa435b-a745-435c-b41d-e1fdfb7cc6df"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "dcf4957d-5af1-4786-98f6-f9b71ff9b3a1",
              "name": "Get URL Reputation -> Get URL Rating from VirusTotal",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/2a37459d-9293-4196-b1f9-f1928a318dc1",
              "sourceStep": "/api/3/workflow_steps/d941fbb8-f9c6-4f3e-bde0-e0990a8eb8a2"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "70f6895b-fe17-43bc-a1c0-12d617185961",
              "name": "Create URL Indicator -> Update Alert with Existing Indicator",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/40020287-b79d-4915-bbb9-aa4f97e59496",
              "sourceStep": "/api/3/workflow_steps/0191a4bb-c832-437d-8f8a-85eeb3bdd549"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "eaecc536-c8ae-4a13-b030-533d7d026d10",
              "name": "Get Local URLs Whitelist -> Is URL Known",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/b3aa435b-a745-435c-b41d-e1fdfb7cc6df",
              "sourceStep": "/api/3/workflow_steps/d4896833-9e95-4e6a-835c-55187c452ccc"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "585a4b01-2b23-4084-8255-fa04deaee9ef",
              "name": "Get URL Reputation -> Get URL Rating from IBM XForce",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/3a1efbc9-56c5-43ae-830d-e0858e7731ec",
              "sourceStep": "/api/3/workflow_steps/d941fbb8-f9c6-4f3e-bde0-e0990a8eb8a2"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "f0504c4a-e459-4bd7-b964-34813550444c",
              "name": "Is URL Known -> Create URL Indicator",
              "label": "Yes",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/0191a4bb-c832-437d-8f8a-85eeb3bdd549",
              "sourceStep": "/api/3/workflow_steps/b3aa435b-a745-435c-b41d-e1fdfb7cc6df"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "04594d9c-861c-4903-a7c2-34ab9f856a78",
              "name": "Compute Average Score -> Is URL Unrated",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/9dcb8d9d-9b12-4c11-86f5-456f5f063b51",
              "sourceStep": "/api/3/workflow_steps/a66ad14c-5f35-4a04-bb9d-8a9675c29ea9"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "2dd95cd5-d829-4c20-b55c-bace3ff7be71",
              "name": "Find Indicator -> Get Local URLs Blacklist",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/d3f108c8-0b52-4212-97a6-60d602fbf645",
              "sourceStep": "/api/3/workflow_steps/899b4e94-b5e6-4a15-9ec2-0aae7f66d1fb"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "e8ffa688-bfa9-4754-8ec1-ce1b34e3add5",
              "name": "Find Indicator -> Get Local URLs Whitelist",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/d4896833-9e95-4e6a-835c-55187c452ccc",
              "sourceStep": "/api/3/workflow_steps/899b4e94-b5e6-4a15-9ec2-0aae7f66d1fb"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "da4f7e6f-23b3-42ad-8f70-76ca7260f75e",
              "name": "Fields Mapping -> Update Alert Attributes",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/8c46da66-ac0e-4a59-bdfb-9cc0314ea980",
              "sourceStep": "/api/3/workflow_steps/0b5ae245-eda6-49b2-a26d-b34660d84dc4"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "9ab61d01-ddb7-4463-affd-0b95b585192c",
              "name": "Update Alert Attributes -> Find Indicator",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/899b4e94-b5e6-4a15-9ec2-0aae7f66d1fb",
              "sourceStep": "/api/3/workflow_steps/8c46da66-ac0e-4a59-bdfb-9cc0314ea980"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c4ef14b0-03a0-4823-bae6-bfae93284dc7",
              "name": "Prompt Whether to Block URL -> User Requested URL Block",
              "label": "Block List",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/044a8a3d-373c-4f69-9a0e-16394dbdfaf7",
              "sourceStep": "/api/3/workflow_steps/6ce11c76-dd60-4566-83db-5b92c79fea17"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "ddd213f3-8ee1-40aa-9130-d43106e7b818",
              "name": "User Requested URL Block -> Create URL Indicator When Unrated and Blocked",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/31ec48a5-f38a-459c-96ec-c912821887cf",
              "sourceStep": "/api/3/workflow_steps/044a8a3d-373c-4f69-9a0e-16394dbdfaf7"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "33bc9761-5feb-4407-8238-6c4758fcc16c",
              "name": "Create URL Indicator When Unrated and Blocked -> Close Alert as URL Blocked Manually",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/bbc14413-838f-4a25-bdd9-d5a8a1f4f3dc",
              "sourceStep": "/api/3/workflow_steps/31ec48a5-f38a-459c-96ec-c912821887cf"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c98fa62e-94c9-4bb2-be63-98032a50a5a4",
              "name": "Prompt Whether to Block URL -> User Requested URL Allow",
              "label": "Allow List",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/d5c93483-5983-47c2-9fd8-f94ef9d232f0",
              "sourceStep": "/api/3/workflow_steps/6ce11c76-dd60-4566-83db-5b92c79fea17"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c9d1e2d8-5522-4cad-a973-8f56749e38c1",
              "name": "Create URL Indicator When Unrated and Allowed -> Close Alert as URL Allowed",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/f51eeefe-a953-463d-a8ed-927703186248",
              "sourceStep": "/api/3/workflow_steps/4ec68cfa-67a4-4b06-8fda-30f4c97047d0"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "64cb3709-f4d3-4288-81e0-51c0ee801f3f",
              "name": "User Requested URL Allow -> Create URL Indicator When Unrated and Allowed",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/4ec68cfa-67a4-4b06-8fda-30f4c97047d0",
              "sourceStep": "/api/3/workflow_steps/d5c93483-5983-47c2-9fd8-f94ef9d232f0"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3f08edaa-fb64-42d7-9445-63d748a6a024",
              "name": "Automatic URL Block -> Create URL Indicator When Rated and Not Known",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/e3dd0e4f-59e9-4a13-858b-d8ff5fad8143",
              "sourceStep": "/api/3/workflow_steps/41ab5959-3d25-4029-8e2e-78179f250dee"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "68e58767-dd35-47a4-a574-57f027d80247",
              "name": "Create URL Indicator When Rated and Not Known -> Close Alert as Automatic URL Blocked",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/5454ff14-8487-4687-94ce-d8992ab1eec7",
              "sourceStep": "/api/3/workflow_steps/e3dd0e4f-59e9-4a13-858b-d8ff5fad8143"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "1975c004-3cbd-49ef-b1c7-90331a412251",
              "name": "is URL Malicious -> Manual Decision Required",
              "label": "No",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/87aa2fd2-ebb4-46e9-abde-212e1d6bcb48",
              "sourceStep": "/api/3/workflow_steps/9dcb8d9d-9b12-4c11-86f5-456f5f063b51"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "d3fa13bb-7c98-425b-a2ee-7b9172e70873",
              "name": "Manual Decision Required -> Prompt Whether to Block URL",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/6ce11c76-dd60-4566-83db-5b92c79fea17",
              "sourceStep": "/api/3/workflow_steps/87aa2fd2-ebb4-46e9-abde-212e1d6bcb48"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "19ae2e8b-b951-4dd1-944d-30d08b800544",
              "name": "is URL Malicious -> Automatic Blocking Of URL",
              "label": "Yes",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/8aacc8fa-ac83-4f75-857c-478c17f0f6f5",
              "sourceStep": "/api/3/workflow_steps/9dcb8d9d-9b12-4c11-86f5-456f5f063b51"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "1419ab5a-e6a9-4382-bf8c-2798ffa46b65",
              "name": "Automatic Blocking Of URL -> Automatic URL Block",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/41ab5959-3d25-4029-8e2e-78179f250dee",
              "sourceStep": "/api/3/workflow_steps/8aacc8fa-ac83-4f75-857c-478c17f0f6f5"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "20972eaf-e997-48e2-bf7f-77ede4bdb2fd",
              "name": "Get URL Rating from IBM XForce -> Get XForce URL Reputation",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/89b380f6-24ca-4654-bd08-2c9ddaf3b524",
              "sourceStep": "/api/3/workflow_steps/3a1efbc9-56c5-43ae-830d-e0858e7731ec"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c7b6c039-6b15-4dd4-8bc3-0148ba3e13c1",
              "name": "Get XForce URL Reputation -> Report XForce URL Reputation",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/83821d59-6680-4b65-853a-503e1d633dd5",
              "sourceStep": "/api/3/workflow_steps/89b380f6-24ca-4654-bd08-2c9ddaf3b524"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "28e24a32-d617-495f-804e-146d3264412b",
              "name": "Report XForce URL Reputation -> Compute Average Score",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/a66ad14c-5f35-4a04-bb9d-8a9675c29ea9",
              "sourceStep": "/api/3/workflow_steps/83821d59-6680-4b65-853a-503e1d633dd5"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "36c3f5d6-a2d8-4bbe-a919-e9bd4d2c7c25",
              "name": "Get URL Rating from VirusTotal -> Set VT Reputation",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/7e8ac904-01dc-4bbd-8bd6-58df57682c49",
              "sourceStep": "/api/3/workflow_steps/2a37459d-9293-4196-b1f9-f1928a318dc1"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "247cba31-1f57-40c1-ba12-9baded82a91a",
              "name": "Set VT Reputation -> Get VT Reputation",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/97a41571-919c-46e4-a79e-e8e1720c543c",
              "sourceStep": "/api/3/workflow_steps/7e8ac904-01dc-4bbd-8bd6-58df57682c49"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "5b7d6cd0-3183-4a51-8ef8-31c6652686a4",
              "name": "Add Url Rating -> Compute Average Score",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/a66ad14c-5f35-4a04-bb9d-8a9675c29ea9",
              "sourceStep": "/api/3/workflow_steps/708da227-6c9e-4c35-90f8-115acc8eef09"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "caef3a42-4c82-4c37-92c9-35bc48c2f0af",
              "name": "Get VT Reputation -> Add Url Rating",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/708da227-6c9e-4c35-90f8-115acc8eef09",
              "sourceStep": "/api/3/workflow_steps/97a41571-919c-46e4-a79e-e8e1720c543c"
            }
          ],
          "versions": null,
          "lastModifyDate": 1593601593,
          "uuid": "4b29ccd7-21fb-491f-bcb4-07f611c5f061",
          "recordTags": [],
          "isPrivate": false,
          "owners": []
        }
      ],
      "uuid": "f2201bf8-10f5-424b-a4d8-498e6f33750b",
      "recordTags": []
    }
  ],
  "macros": [
    {
      "name": "Tomorrow_Date",
      "value": "{{arrow.utcnow().shift(hours=+24).timestamp}}",
      "default_value": null
    },
    {
      "name": "Current_Date",
      "value": "{{arrow.utcnow().timestamp}}",
      "default_value": null
    }
  ],
  "exported_tags": []
}