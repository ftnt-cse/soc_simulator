{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "00 - SIM Compromised WebServer",
      "description": null,
      "visible": true,
      "image": null,
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "File_Integrity_Investigation",
          "aliasName": null,
          "description": "Investigate file content change",
          "collection": "/api/3/workflow_collections/fc4bddca-9896-432e-b2c2-e9dc4f0d1bb2",
          "tag": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/806c8290-2d02-4583-b9bd-f0cead77be9a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "source",
                      "value": "FSMSIM-CWS-2",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                }
              },
              "status": null,
              "left": "126",
              "top": "30",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "806c8290-2d02-4583-b9bd-f0cead77be9a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "incident_file_name": "{{(vars.input.records[0].sourcedata.incident_data.attributes.incidentDetail | regex_search(\"fileName:([^,]*)\")).split(':')[1]}}",
                "alerts_severity_map": "{'MINIMAL': {{'Severity'| picklist('Minimal') }}, 'LOW': {{'Severity'| picklist('Low') }}, 'MEDIUM': {{'Severity'| picklist('Medium') }}, 'HIGH': {{'Severity'| picklist('High') }}, 'CRITICAL': {{'Severity'| picklist('Critical') }}}",
                "incident_source_data": "{{vars.input.records[0].sourcedata.incident_data}}",
                "incident_src_hashcode": "{{(vars.input.records[0].sourcedata.incident_data.attributes.incidentDetail | regex_search(\"hashCode:([^,]*)\")).split(':')[1]}}",
                "incident_modification_hashcode": "{{(vars.input.records[0].sourcedata.incident_data.attributes.incidentTarget | regex_search(\"targetHashCode:([^,]*)\")).split(':')[1]}}"
              },
              "status": null,
              "left": "126",
              "top": "160",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "73a89225-9a23-4d58-b47d-42e7374408a3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Alert",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Updating the Alert with Virus Total Reputation",
                  "records": ""
                },
                "resource": {
                  "name": "{{vars.incident_source_data.attributes.eventName}}-{{vars.incident_source_data.attributes.incidentId}}",
                  "type": {
                    "id": 124,
                    "@id": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Other / Unknown",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Other / Unknown",
                    "orderIndex": 13
                  },
                  "dueBy": "{{globalVars.Current_Data}}",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "domain": "fortielab.com",
                  "status": {
                    "id": 118,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "fileHash": "{{vars.incident_modification_hashcode}}",
                  "fileName": "{{vars.incident_file_name | basename}}",
                  "severity": {
                    "id": 177,
                    "@id": "/api/3/picklists/b3c20a3a-ecfd-4adc-a225-0205968e6793",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#D2AC1A",
                    "display": "Medium",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Medium",
                    "orderIndex": 2
                  },
                  "sourceIp": "{%if vars.incident_source_data.attributes.srcIpAddr%}{{vars.incident_source_data.attributes.srcIpAddr}}{%endif%}",
                  "userName": "{{vars.incident_source_data.attributes.user}}",
                  "fileNames": "{{vars.incident_src_hashcode}}",
                  "sourceType": "SIEM",
                  "sourcedata": "{{vars.incident_source_data|toJSON}}",
                  "description": "#### Description:\n> {{vars.incident_source_data.attributes.incidentTitle}}\n> Original File Hash: **{{vars.incident_src_hashcode}}**\n> New File Hash: **{{vars.incident_modification_hashcode}}**\n> Host Name: **{{vars.incident_source_data.attributes.hostName}}**\n> Username: **{{vars.incident_source_data.attributes.user}}**\n\n### VirusTotal reputation of the dropped file: <span style=\"color:red\">{{vars.steps.Get_Modified_File_Reputation.data.aggregate}}</span>",
                  "computerName": "{{vars.incident_source_data.attributes.hostName}}",
                  "destinationIp": "{%if vars.incident_source_data.attributes.destIpAddr%}{{vars.incident_source_data.attributes.destIpAddr}}{%endif%}",
                  "sourceProcess": "httpd",
                  "killChainPhase": {
                    "id": 376,
                    "@id": "/api/3/picklists/1713c4c8-7e66-4bb9-bf46-096a9e2bc071",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Exploitation",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Exploitation",
                    "orderIndex": 4
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "127",
              "top": "511",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "b59ea21e-d700-40d1-844c-73add83f7e90"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Modified File Reputation",
              "description": null,
              "arguments": {
                "name": "VirusTotal",
                "config": "471aeb8c-8a8f-4a91-aa73-aee8012b31f8",
                "params": {
                  "file_hash": "{{vars.incident_modification_hashcode}}"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Get The dropped file reputation from VirusTotal",
                  "records": ""
                },
                "version": "1.0.1",
                "connector": "virustotal",
                "operation": "file_reputation",
                "operationTitle": "Get File Reputation",
                "step_variables": []
              },
              "status": null,
              "left": "127",
              "top": "280",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "95b30e64-24a2-4563-8d3e-15601577f289"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "value": "{{vars.incident_modification_hashcode}}",
                  "__replace": "true",
                  "reputation": {
                    "id": 109,
                    "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#c42323",
                    "display": "Malicious",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Malicious",
                    "orderIndex": 1
                  },
                  "description": "New file dropped",
                  "filehashMD5": "{{vars.incident_modification_hashcode}}",
                  "indicatorStatus": {
                    "id": 366,
                    "@id": "/api/3/picklists/fa29fe48-f01e-476f-bb33-c910f5795b57",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Blocked",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "Blocked",
                    "orderIndex": 0
                  },
                  "typeofindicator": {
                    "id": 74,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 4
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "127",
              "top": "400",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "b21e91af-c3e9-459c-a6a3-67e04cc27a5a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "24d62258-b49d-4b68-97f5-12bc7014e2ec",
              "name": "Start -> Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/73a89225-9a23-4d58-b47d-42e7374408a3",
              "sourceStep": "/api/3/workflow_steps/806c8290-2d02-4583-b9bd-f0cead77be9a"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "b19e2670-9ea1-4b21-945c-f13bb24d18c3",
              "name": "Configuration -> Get Modified File Reputation",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/95b30e64-24a2-4563-8d3e-15601577f289",
              "sourceStep": "/api/3/workflow_steps/73a89225-9a23-4d58-b47d-42e7374408a3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "07f38350-f625-488f-bcd4-d48171aafc36",
              "name": "Get Modified File Reputation -> Create Indicator",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/b21e91af-c3e9-459c-a6a3-67e04cc27a5a",
              "sourceStep": "/api/3/workflow_steps/95b30e64-24a2-4563-8d3e-15601577f289"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "18f1620c-de06-4314-9a37-4f95296af094",
              "name": "Create Indicator -> Update Alert",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/b59ea21e-d700-40d1-844c-73add83f7e90",
              "sourceStep": "/api/3/workflow_steps/b21e91af-c3e9-459c-a6a3-67e04cc27a5a"
            }
          ],
          "versions": null,
          "lastModifyDate": 1590776476,
          "uuid": "57733aa2-64be-4b9f-9ac0-99b92cbee642",
          "recordTags": [],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lateral Movement Assessment and Remediation",
          "aliasName": null,
          "description": "Identifies compromised targets and isolates them",
          "collection": "/api/3/workflow_collections/fc4bddca-9896-432e-b2c2-e9dc4f0d1bb2",
          "tag": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/0960d15b-f886-4737-ae53-7cfb61621afd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ba2e3694-7778-4656-8d4b-680463080263",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "left": "300",
              "top": "30",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "0960d15b-f886-4737-ae53-7cfb61621afd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Block Infected Machines",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGate",
                "config": "2f403563-7c5d-427e-ad2f-bb8a4e28b0d3",
                "params": {
                  "vdom": "",
                  "method": "Quarantine Based",
                  "duration": 200,
                  "ip_addresses": "{{vars.infected_machines}}",
                  "time_to_live": "Custom Time"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Block Infetced machines <span style=\"color:red\">{{vars.infected_machines}}</span> on FortiGate\n",
                  "records": ""
                },
                "version": "3.0.0",
                "connector": "fortigate-firewall",
                "operation": "block_ip",
                "operationTitle": "Block IP Address",
                "step_variables": []
              },
              "status": null,
              "left": "127",
              "top": "710",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "703cff3e-513c-4eea-9ca4-f8faccc7a8f6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Parse SIEM response",
              "description": null,
              "arguments": {
                "infected_machines": "{{(vars.steps.Get_Potentially_Infected_PCs.data | json_query('events[*].attributes.srcIpAddr'))|unique}}"
              },
              "status": null,
              "left": "125",
              "top": "435",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "8a453fc9-7eed-4480-a593-57da3cdffdc4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Potentially Infected PCs",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "ac3ca87b-205f-43ab-9b66-91fe9ba13f98",
                "params": {
                  "value": 120,
                  "rel_time": "Minutes",
                  "reportName": "uriStem CONTAIN \"/html/index.php\"  AND  httpUserAgent CONTAIN \"Windows\"",
                  "time_selection": "Relative Time"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Query FortiSIEM for potentially infected hosts\n",
                  "records": ""
                },
                "version": "3.0.1",
                "connector": "fortinet-fortisiem",
                "operation": "run_report",
                "operationTitle": "Run Report",
                "step_variables": []
              },
              "status": null,
              "left": "125",
              "top": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6bb4732b-b637-4a34-b253-2fe60716bed6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Target File",
              "description": null,
              "arguments": {
                "target_file": "{{(vars.input.records[0].description| regex_search(\"uriStem:\\s+([^?]*)\")).split(\": \")[1]}}"
              },
              "status": null,
              "left": "300",
              "top": "165",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "11122d4c-de84-496c-b564-bc3a05779cd5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Restore Original File",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "86fccd04-96e3-4435-8506-57137a158fbd",
                "params": {
                  "cmd": "wget https://raw.githubusercontent.com/ethicalhack3r/DVWA/master/index.php -O /var/www/html/index.php",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Restoring The Original Web Server File ",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "ignore_errors": true,
                "operationTitle": "Execute remote command",
                "step_variables": []
              },
              "status": null,
              "left": "475",
              "top": "570",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "22bb85da-60ea-4ec7-a4ce-7f4f5ac93925"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get HashCode",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "86fccd04-96e3-4435-8506-57137a158fbd",
                "params": {
                  "cmd": "md5sum /var/www/html/index.php",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Compute the Hash code of the restored file:\n{{vars.result.message}}",
                  "records": ""
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "ignore_errors": true,
                "operationTitle": "Execute remote command",
                "step_variables": []
              },
              "status": null,
              "left": "475",
              "top": "705",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2ce0a8e9-abe9-4349-a1f5-43508554745a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set HashCode",
              "description": null,
              "arguments": {
                "restored_hashcode": "{{vars.steps.Get_HashCode.data| regex_search(\"([^\\s]*)\")}}"
              },
              "status": null,
              "left": "475",
              "top": "840",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "60a309c9-d421-4c7b-bbfb-a56fc4debe76"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Related Alerts",
              "description": null,
              "arguments": {
                "alert_data": "{{ (vars.input.records[0]['@id'] + \"?$relationships=true\") | fromIRI }}"
              },
              "status": null,
              "left": "475",
              "top": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "c599818d-0dd0-4612-bb65-eac32afa8093"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Original HashCode",
              "description": null,
              "arguments": {
                "file_hashcode": "{{(vars.alert_data.alerts| json_query('[*].fileNames')).0}}"
              },
              "status": null,
              "left": "475",
              "top": "435",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "ee39b91f-3ff4-4045-8c3f-35bcec3e3f8f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Has the file been restored",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/e29e05ab-8200-465c-a039-b407f26120a2",
                    "condition": "{{ vars.file_hashcode == vars.restored_hashcode }}"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/eb81efe1-1628-46d3-a7ed-09a62e117fe2"
                  }
                ]
              },
              "status": null,
              "left": "475",
              "top": "975",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "92debffc-38e3-47a4-889e-d43c4927953d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Manual Remediation task",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "**TASK:**\n{%if vars.file_hashcode == vars.restored_hashcode%}\n> The modified Web Server File with hashcode: \n {{vars.file_hashcode}} has been restored\n{% else %}\n> The modified Web Server File with hashcode: \n {{vars.file_hashcode}} could not be restored, you will have to restore it manually.\n{%endif%}\n> The Vulnerability used by the attacker to compromise the web server is still present, you are required to identify it and patch the web server accordignly",
                  "records": ""
                },
                "resource": {
                  "name": "Incident Manual Remediations",
                  "type": {
                    "id": 122,
                    "@id": "/api/3/picklists/826ad76d-e418-4928-9bc9-ea552ebcc5f9",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Incident Response",
                    "listName": "/api/3/picklist_names/b837e375-76af-4ba5-b6a1-bd1c3cd27292",
                    "itemValue": "Incident Response",
                    "orderIndex": 6
                  },
                  "priority": {
                    "id": 139,
                    "@id": "/api/3/picklists/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#e36c29",
                    "display": "High",
                    "listName": "/api/3/picklist_names/bea9a490-50d1-4597-8ad9-24422e10676e",
                    "itemValue": "High",
                    "orderIndex": 2
                  },
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "description": "{%if vars.file_hashcode == vars.restored_hashcode%}\n> The modified Web Server File with hashcode: \n {{vars.file_hashcode}} has been restored\n{% else %}\n> The modified Web Server File with hashcode: \n {{vars.file_hashcode}} could not be restored, you will have to restore it manually.\n{%endif%}\n> The Vulnerability used by the attacker to compromise the web server is still present, you are required to identify it and patch the web server accordignly",
                  "assignedToPerson": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/tasks",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "300",
              "top": "1110",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "eb81efe1-1628-46d3-a7ed-09a62e117fe2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Incident",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Updating Incident...",
                  "records": ""
                },
                "resource": {
                  "description": "{{vars.input.records[0].description}}\n\n> Incident has been Remediated and the compromised file restored.\nAll infected machines below are about to be qurantined by the Firewall shortly\n{{vars.infected_machines}}\n\nYou can stop the playbook and prevent that if required, you have about 1 min"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "650",
              "top": "1110",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "e29e05ab-8200-465c-a039-b407f26120a2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Wait for a while",
              "description": null,
              "arguments": {
                "delay": {
                  "days": 0,
                  "hours": 0,
                  "weeks": 0,
                  "minutes": 0,
                  "seconds": 60
                }
              },
              "status": null,
              "left": "126",
              "top": "572",
              "stepType": "/api/3/workflow_step_types/6832e556-b9c7-497a-babe-feda3bd27dbf",
              "uuid": "73838f45-4c18-42c3-b988-6c9a0411dfdb"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "18bac03c-e87a-4b9e-b60a-8fb9b46ad27d",
              "name": "Get Potentially Infected PCs -> Parse SIEM response",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/8a453fc9-7eed-4480-a593-57da3cdffdc4",
              "sourceStep": "/api/3/workflow_steps/6bb4732b-b637-4a34-b253-2fe60716bed6"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "b191bc37-af66-49ba-9368-e7a70707a699",
              "name": "Start -> Get Target File",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/11122d4c-de84-496c-b564-bc3a05779cd5",
              "sourceStep": "/api/3/workflow_steps/0960d15b-f886-4737-ae53-7cfb61621afd"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "32844738-d273-46f6-b620-2495867169a0",
              "name": "Restore Original File -> Get HashCode",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/2ce0a8e9-abe9-4349-a1f5-43508554745a",
              "sourceStep": "/api/3/workflow_steps/22bb85da-60ea-4ec7-a4ce-7f4f5ac93925"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "6a16d47c-124c-43c2-99b2-dbf327844e22",
              "name": "Get HashCode -> Set HashCode",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/60a309c9-d421-4c7b-bbfb-a56fc4debe76",
              "sourceStep": "/api/3/workflow_steps/2ce0a8e9-abe9-4349-a1f5-43508554745a"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c4ab9847-3818-4c08-a546-963db229f6ec",
              "name": "Get Related Alerts -> Get Original HashCode",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/ee39b91f-3ff4-4045-8c3f-35bcec3e3f8f",
              "sourceStep": "/api/3/workflow_steps/c599818d-0dd0-4612-bb65-eac32afa8093"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "ffacaddb-76f0-4b3a-bf0e-0f9e7de7e21a",
              "name": "Get Original HashCode -> Restore Original File",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/22bb85da-60ea-4ec7-a4ce-7f4f5ac93925",
              "sourceStep": "/api/3/workflow_steps/ee39b91f-3ff4-4045-8c3f-35bcec3e3f8f"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "36a6e57e-6b00-4a48-870a-68152dad13ca",
              "name": "Set HashCode -> Compare HashCodes",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/92debffc-38e3-47a4-889e-d43c4927953d",
              "sourceStep": "/api/3/workflow_steps/60a309c9-d421-4c7b-bbfb-a56fc4debe76"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "4fc2a3bb-ed4a-4e0d-adf6-aec1996b2a00",
              "name": "Compare HashCodes -> Create Manual Remediation task",
              "label": "no",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/eb81efe1-1628-46d3-a7ed-09a62e117fe2",
              "sourceStep": "/api/3/workflow_steps/92debffc-38e3-47a4-889e-d43c4927953d"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "96ca5c55-985c-481f-840e-80080c456991",
              "name": "Has the file been restored -> Update Incident",
              "label": "yes",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/e29e05ab-8200-465c-a039-b407f26120a2",
              "sourceStep": "/api/3/workflow_steps/92debffc-38e3-47a4-889e-d43c4927953d"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "94fa2b15-2e0e-4e36-8fa1-c7ebe011632d",
              "name": "Get Target File -> Get Related Alerts",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/c599818d-0dd0-4612-bb65-eac32afa8093",
              "sourceStep": "/api/3/workflow_steps/11122d4c-de84-496c-b564-bc3a05779cd5"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "482fea62-03ed-49ce-8ded-564a2d200e93",
              "name": "Get Target File -> Get Potentially Infected PCs",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/6bb4732b-b637-4a34-b253-2fe60716bed6",
              "sourceStep": "/api/3/workflow_steps/11122d4c-de84-496c-b564-bc3a05779cd5"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3dc1b577-94ee-4d07-bc70-316e672e3b5d",
              "name": "Parse SIEM response -> Wait for a while",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/73838f45-4c18-42c3-b988-6c9a0411dfdb",
              "sourceStep": "/api/3/workflow_steps/8a453fc9-7eed-4480-a593-57da3cdffdc4"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3abd9623-3df4-41a6-aa45-5570a0af0106",
              "name": "Wait for a while -> Block Infected Machines",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/703cff3e-513c-4eea-9ca4-f8faccc7a8f6",
              "sourceStep": "/api/3/workflow_steps/73838f45-4c18-42c3-b988-6c9a0411dfdb"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "57e43ff5-be70-4233-8514-3c84c506ecd4",
              "name": "Update Incident -> Create Manual Remediation task",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/eb81efe1-1628-46d3-a7ed-09a62e117fe2",
              "sourceStep": "/api/3/workflow_steps/e29e05ab-8200-465c-a039-b407f26120a2"
            }
          ],
          "versions": null,
          "lastModifyDate": 1590777560,
          "uuid": "71cdcdbc-f8f4-4485-a8e2-a3b68787a25c",
          "recordTags": [],
          "isPrivate": false,
          "owners": []
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Compromised_WebServer_Investigation",
          "aliasName": null,
          "description": "Investigate Web Server Remote Exploit",
          "collection": "/api/3/workflow_collections/fc4bddca-9896-432e-b2c2-e9dc4f0d1bb2",
          "tag": null,
          "isActive": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/7e89cb0d-65c2-4dab-a495-937478e53f63",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "source",
                      "value": "FSMSIM-CWS-1",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                }
              },
              "status": null,
              "left": "174",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "7e89cb0d-65c2-4dab-a495-937478e53f63"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create WebServer Asset",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Linking the found vulnerability to **{{vars.destination_ip}}**",
                  "records": ""
                },
                "resource": {
                  "ip": "10.0.1.20",
                  "name": "WebServer",
                  "state": {
                    "id": 176,
                    "@id": "/api/3/picklists/b31da3b9-6f87-469e-a1bf-2517c48a7001",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Active",
                    "listName": "/api/3/picklist_names/45de7d2e-8ef0-495e-a6e5-07fddfbd4749",
                    "itemValue": "Active",
                    "orderIndex": 1
                  },
                  "category": {
                    "id": 25,
                    "@id": "/api/3/picklists/1bfa4142-b3f2-4945-8393-66228f9260d3",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Server",
                    "listName": "/api/3/picklist_names/0042bf40-d0e6-4324-ab84-0c7b0703f681",
                    "itemValue": "Server",
                    "orderIndex": 3
                  },
                  "hostname": "webserver.fortielab.com",
                  "__replace": "false",
                  "assetClass": {
                    "id": 53,
                    "@id": "/api/3/picklists/3864918a-79b9-412d-a09e-3f6f13aae2f9",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Software",
                    "listName": "/api/3/picklist_names/54642443-1ab4-4f2b-968e-a0c43907fad0",
                    "itemValue": "Software",
                    "orderIndex": 1
                  },
                  "macAddress": "00:01:22:2A:AC:01",
                  "criticality": {
                    "id": 237,
                    "@id": "/api/3/picklists/f734dfbb-fd61-425e-8a14-ebd560289fac",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#DE7A13",
                    "display": "High",
                    "listName": "/api/3/picklist_names/f8d09b4a-9e91-4096-bbdd-06a9f96ef57e",
                    "itemValue": "High",
                    "orderIndex": 3
                  },
                  "description": "ELS System WebServer",
                  "operatingSystem": {
                    "id": 74,
                    "@id": "/api/3/picklists/50dd4c6b-4dfc-4771-b639-c57454610600",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Linux",
                    "listName": "/api/3/picklist_names/6671f4f2-2fd5-4d00-ba2d-f9fade310689",
                    "itemValue": "Linux",
                    "orderIndex": 0
                  },
                  "vulnerabilities": "{{vars.steps.Record_Vulnerabilities['@id']}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/assets",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "640",
              "top": "567",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "00051be5-76e8-4be5-a817-4794d17f9e98"
            },
            {
              "@type": "WorkflowStep",
              "name": "Record Vulnerabilities",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Found Vulnerability **{{vars.result.cveId}}** on **{{vars.destination_ip}}**",
                  "records": ""
                },
                "resource": {
                  "name": "PhpMoAdmin.moadmin.php.Unauthenticated.Remote.Code.Execution",
                  "risk": "HIGH",
                  "cveId": "CVE-2015-2208",
                  "status": {
                    "id": 219,
                    "@id": "/api/3/picklists/e001be1d-d050-473c-a82d-003bf14c4b1b",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#A51516",
                    "display": "Open",
                    "listName": "/api/3/picklist_names/0b2b995f-0292-43ca-be81-03904250791c",
                    "itemValue": "Open",
                    "orderIndex": 0
                  },
                  "severity": {
                    "id": 56,
                    "@id": "/api/3/picklists/40187287-89fc-4e9c-b717-e9443d57eedb",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#DE7A13",
                    "display": "High",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "High",
                    "orderIndex": 3
                  },
                  "__replace": "",
                  "riskScore": "8",
                  "description": "This indicates an attack attempt against a remote Code Execution vulnerability in phpMoAdmin. The vulnerability is caused by an error when the vulnerable software handles a malicious HTTP request containing a crafted URI. A remote attacker may be able to exploit this to execute arbitrary code within the context of the application, via a crafted HTTP request",
                  "vulnerabilityId": "40243",
                  "pluginPublicationDate": "30-06-2015"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/vulnerabilities",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "334",
              "top": "668",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "7c0b1a3a-167b-489a-9451-7f4a736618ea"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Vulnerability",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "vulnerabilityId",
                      "value": "40243",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "vulnerabilities?$limit=30",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Running Vulnerability Scan on **{{vars.destination_ip}}**",
                  "records": ""
                },
                "step_variables": []
              },
              "status": null,
              "left": "174",
              "top": "460",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "1fd62fc3-e4bd-4401-8de9-9e653bb135fa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Vulnerability Exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/7c0b1a3a-167b-489a-9451-7f4a736618ea"
                  },
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/aac8d116-7f69-422b-b606-69064a754e88",
                    "condition": "{{ vars.steps.Find_Vulnerability|length > 0 }}"
                  }
                ]
              },
              "status": null,
              "left": "174",
              "top": "568",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "8f33b557-f91f-4c51-aec3-5291467cace3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "source_ip": "{{vars.input.records[0].sourcedata.incident_data.attributes.srcIpAddr}}",
                "destination_ip": "{{vars.input.records[0].sourcedata.incident_data.attributes.destIpAddr}}",
                "incident_attack_id": "{{(vars.input.records[0].sourcedata.incident_data.attributes.incidentDetail| regex_search(\"ipsSignatureId:\\d+\")).split(\":\")[1]}}",
                "alerts_severity_map": "{'MINIMAL': {{'Severity'| picklist('Minimal') }}, 'LOW': {{'Severity'| picklist('Low') }}, 'MEDIUM': {{'Severity'| picklist('Medium') }}, 'HIGH': {{'Severity'| picklist('High') }}, 'CRITICAL': {{'Severity'| picklist('Critical') }}}",
                "incident_first_seen": "{{vars.input.records[0].sourcedata.incident_data.attributes.incidentFirstSeen}}",
                "incident_attack_name": "{{(vars.input.records[0].sourcedata.incident_data.attributes.incidentDetail| regex_search(\"attackName:([^,]*)\")).split(\":\")[1].replace(\".\",\"-\")}}",
                "incident_source_data": "{{vars.input.records[0].sourcedata.incident_data}}"
              },
              "status": null,
              "left": "174",
              "top": "129",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "a8aaac05-6c4e-4206-ab84-5f165c7f60be"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Alert",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Setting the Alert details:\n<p>Alert&nbsp;Description:&nbsp;{{vars.incident_source_data.attributes.incidentTitle}}</p>\n</p>{%if vars.incident_source_data.attributes.srcIpAddr%}Source IP:{{vars.incident_source_data.attributes.srcIpAddr}}{%endif%}<br />{%if vars.incident_source_data.attributes.destIpAddr%}Destination IP:&nbsp;{{vars.incident_source_data.attributes.destIpAddr}}{%endif%}</p>\n<a href='https://fortiguard.com/encyclopedia/ips/{{vars.incident_attack_id}}/{{vars.incident_attack_name}}'> <span style=\"color:red\">Click Here</span>for the Attack Details on Fortiguard.com</a>\n",
                  "records": ""
                },
                "resource": {
                  "type": {
                    "id": 124,
                    "@id": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Other / Unknown",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Other / Unknown",
                    "orderIndex": 13
                  },
                  "dueBy": "{{globalVars.Current_Data}}",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "assets": "{{vars.steps.Create_WebServer_Asset['@id']}}",
                  "status": {
                    "id": 118,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "fileName": "{{vars.steps.Identify_Targeted_File.input['targetedFileName:']}}",
                  "severity": {
                    "id": 56,
                    "@id": "/api/3/picklists/40187287-89fc-4e9c-b717-e9443d57eedb",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#DE7A13",
                    "display": "High",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "High",
                    "orderIndex": 3
                  },
                  "indicators": "{{vars.steps.Create_Indicator['@id']}}",
                  "sourceType": "SIEM",
                  "description": "#### Description:\n> {{vars.incident_source_data.attributes.incidentTitle}}\n> {%if vars.incident_source_data.attributes.srcIpAddr%}Source IP:{{vars.incident_source_data.attributes.srcIpAddr}}{%endif%}<br />{%if vars.incident_source_data.attributes.destIpAddr%}Destination IP:&nbsp;{{vars.incident_source_data.attributes.destIpAddr}}{%endif%}\n<a href='https://fortiguard.com/encyclopedia/ips/{{vars.incident_attack_id}}/{{vars.incident_attack_name}}'>Click Here for the Attack Details on Fortiguard.com</a>\n#### Source location\n> {{vars.steps.Get_Attacker_IP_Information.data['asn_country_code']}}-{{vars.steps.Get_Attacker_IP_Information.data['asn_description']}}\n#### Targeted File:\n> uriStem:{{vars.input.records[0].sourcedata.associated_events.event_details[0][0].attributes.uriStem}}\n#### Virus Total Reputation:\n> # **<span style=\"color:red\">{{vars.steps.Get_Attacker_IP_Reputation_VT.data.aggregate}}</span>**\n",
                  "destinationIp": "{%if vars.incident_source_data.attributes.destIpAddr%}{{vars.incident_source_data.attributes.destIpAddr}}{%endif%}",
                  "sourceProcess": "httpd",
                  "killChainPhase": {
                    "id": 376,
                    "@id": "/api/3/picklists/1713c4c8-7e66-4bb9-bf46-096a9e2bc071",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Exploitation",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Exploitation",
                    "orderIndex": 4
                  },
                  "vulnerabilities": "{{vars.steps.Record_Vulnerabilities['@id']}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "980",
              "top": "532",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "a17cecaa-9497-4996-94c1-7cd640befa60"
            },
            {
              "@type": "WorkflowStep",
              "name": "TASK_Check if server is vulnerable to the Attack",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "**TASK:**\n\nCompare the received Attack CVE with the list of the Asset Vulnerabilities.\n1) Identify the Attack Vulnerability CVE via FortiGuard <a href='https://fortiguard.com/encyclopedia/ips/{{vars.incident_attack_id}}/{{vars.incident_attack_name}}'>Right click here => Open in a new TAB</a>\n2) Compare the CVE with the below CVE to which the Asset is vulnerable:\n{{vars.steps.Record_Vulnerabilities.cveId}}\n3) if the above CVE matches the one on FortiGuard escalate the alert\n    - Open the alert\n    - Click Escalate Button on the bottom left of the page\n    - Fill Incident Name: Web Server Remote Exploit\n    - Set Severity to High\n    - Set Incident Lead to your username\n    - Fill Escalation Reason: Attack on vulnerable web server",
                  "records": ""
                },
                "resource": {
                  "name": "Check if server is vulnerable to the Attack",
                  "type": {
                    "id": 96,
                    "@id": "/api/3/picklists/6d113f01-123a-4c78-b68c-029e16df9b8b",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Other",
                    "listName": "/api/3/picklist_names/b837e375-76af-4ba5-b6a1-bd1c3cd27292",
                    "itemValue": "Other",
                    "orderIndex": 9
                  },
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "status": {
                    "id": 169,
                    "@id": "/api/3/picklists/ab65eb0f-e7a7-4993-8474-da5c8b52f380",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Assigned",
                    "listName": "/api/3/picklist_names/21ddbcfd-b4a3-4273-adea-c674fe47d643",
                    "itemValue": "Assigned",
                    "orderIndex": 0
                  },
                  "priority": {
                    "id": 139,
                    "@id": "/api/3/picklists/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#e36c29",
                    "display": "High",
                    "listName": "/api/3/picklist_names/bea9a490-50d1-4597-8ad9-24422e10676e",
                    "itemValue": "High",
                    "orderIndex": 2
                  },
                  "taskdata": "Check if the server is vulnerable to the Attack",
                  "tasktype": "Manual Task",
                  "__replace": "",
                  "startDate": "{{globalVars.Current_Date}}",
                  "description": "\nCompare the received Attack CVE with the list of the Asset Vulnerabilities.\n1) Identify the Attack Vulnerability CVE via FortiGuard <a href='https://fortiguard.com/encyclopedia/ips/{{vars.incident_attack_id}}/{{vars.incident_attack_name}}'>Right click here => Open in a new TAB</a>\n2) Compare the CVE with the below CVE to which the Asset is vulnerable:\n{{vars.steps.Record_Vulnerabilities.cveId}}\n3) if the above CVE matches the one on FortiGuard escalate the alert\n    - Open the alert\n    - Click Escalate Button on the bottom left of the page\n    - Fill Incident Name: Web Server Remote Exploit\n    - Set Severity to High\n    - Set Incident Lead to your username\n    - Fill Escalation Reason: Attack on vulnerable web server",
                  "assignedOnDate": "{{globalVars.Current_Date}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/tasks",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "980",
              "top": "640",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "6ba453c4-b2ff-4d9c-b728-94234edc7b98"
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Previous Vulnerabilities",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.steps.Find_Vulnerability[0]['@id']}}",
                  "body": "",
                  "method": "DELETE"
                },
                "version": "3.0.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "left": "5",
              "top": "668",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "aac8d116-7f69-422b-b606-69064a754e88"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Attacker IP Information",
              "description": null,
              "arguments": {
                "name": "Whois RDAP",
                "config": "494aff8a-0a09-4dd6-b151-98e4a3555fe0",
                "params": {
                  "ip": "{{vars.source_ip}}"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Get Attacker IP **{{vars.source_ip}}** Whois Information\nClick on the notification Bell on the top right corner of the page and authorize an Email to be sent to the IP Prefix owner if the attack is a true positive.",
                  "records": ""
                },
                "version": "1.0.0",
                "connector": "whois-rdap",
                "operation": "whois_ip",
                "operationTitle": "Whois IP",
                "step_variables": {
                  "whois_artifacts": "{{vars.result.data | extract_artifacts}}"
                }
              },
              "status": null,
              "left": "174",
              "top": "233",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "fa4626e0-9b29-4783-b4d6-c83947fb4219"
            },
            {
              "@type": "WorkflowStep",
              "name": "Email Notification to ISP",
              "description": null,
              "arguments": {
                "resource": {
                  "method": {
                    "id": 116,
                    "@id": "/api/3/picklists/7a04788b-5128-4288-a0fc-6e82d18c3b7b",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "System",
                    "listName": "/api/3/picklist_names/d7bdd0ba-d721-4324-bec5-410e23f0f485",
                    "itemValue": "System",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 208,
                    "@id": "/api/3/picklists/d26464e0-1df4-46c2-a032-018911ba0c40",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#bf9937",
                    "listName": "/api/3/picklist_names/ce294c1f-9318-425f-9a12-2957292f4cbf",
                    "itemValue": "Pending",
                    "orderIndex": 2
                  },
                  "assignedTo": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
                  "playbookiri": "api/3/workflows/df538bef-a008-4137-91f3-0505bcb6d1f6",
                  "playbookname": "Compromised_WebServer_Investigation",
                  "playbookuuid": "df538bef-a008-4137-91f3-0505bcb6d1f6",
                  "approvaldescription": "Should I send an email to the attacker ISP ?"
                },
                "collection": "approvals",
                "step_variables": []
              },
              "status": null,
              "left": "986",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/6832e556-b9c7-497a-babe-feda3bd27dcg",
              "uuid": "f48e815d-9e1a-4556-8d8f-2decc9fdaf5f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Send Email to ISP",
              "description": null,
              "arguments": {
                "config": "88c3d39c-2fa9-4731-b00d-29815008f17c",
                "params": {
                  "cc": "",
                  "to": "{{vars.whois_artifacts.Email[0]}}",
                  "bcc": "",
                  "from": "",
                  "type": "Manual Input",
                  "content": "We were object of a remote exploit attack on our assets from your IP {{vars.source_ip}} kindly take the appropriate measures to prevent this in the future.",
                  "subject": "Remote exploit from your Prefix",
                  "iri_list": "",
                  "body_type": "Plain Text",
                  "file_name": "",
                  "file_path": ""
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Sending a complain message to the Attacker ISP at {{vars.whois_artifacts.Email[0]}}",
                  "records": ""
                },
                "version": "2.3.3",
                "from_str": "admin@example.com",
                "connector": "smtp",
                "operation": "send_email_new",
                "operationTitle": "Send Email",
                "step_variables": []
              },
              "status": null,
              "left": "1327",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/4c0019b2-055c-44d0-968c-678a0c2d762e",
              "uuid": "b4e66339-f021-40d0-b310-66b33eb2f77c"
            },
            {
              "@type": "WorkflowStep",
              "name": "ISP Contact Exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/f48e815d-9e1a-4556-8d8f-2decc9fdaf5f",
                    "condition": "{{ vars.whois_artifacts.Email[0]|length > 0 }}"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/9993c966-adbf-4c1b-af3d-22e54989405a"
                  }
                ]
              },
              "status": null,
              "left": "640",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "bf35a32b-37cf-458e-bb85-5a18aa36abc3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Nothing",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.0.2",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "left": "640",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "9993c966-adbf-4c1b-af3d-22e54989405a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Attacker IP Reputation VT",
              "description": null,
              "arguments": {
                "name": "VirusTotal",
                "config": "fae557ca-f6dd-46eb-928b-5ac8150c9329",
                "params": {
                  "ip": "{{vars.source_ip}}"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Attacker IP Reputation Score from VirusTotal.com: {{vars.result.data.aggregate}}",
                  "records": ""
                },
                "version": "1.0.1",
                "connector": "virustotal",
                "operation": "query_ip",
                "operationTitle": "Get IP Reputation",
                "step_variables": []
              },
              "status": null,
              "left": "174",
              "top": "340",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "1b38e1d9-39f8-4663-a95e-f7efaa6276d9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Identify Targeted File",
              "description": null,
              "arguments": {
                "type": "InputBased",
                "input": {
                  "schema": {
                    "title": "Identify Targeted File",
                    "description": "Browse the Alert Source Data (Open new window) and identify the file targeted by the attack",
                    "inputVariables": [
                      {
                        "name": "targetedFileName:",
                        "type": "string",
                        "label": "Targeted File Name:",
                        "tooltip": "",
                        "dataType": "text",
                        "formType": "text",
                        "required": true,
                        "_expanded": true,
                        "moduleField": "fileName",
                        "useRecordFieldDefault": true
                      }
                    ]
                  }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Identify the attacked file name in the URL field, it's the last item of the URI, exp: www.site.com/path/to/file.php target file is file.php.\nIf the manual task popup doesn't appear automatically, click on the Task notification on the top right and select the pending task",
                  "records": ""
                },
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Ok",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/0bad59c9-b33f-483d-a213-fb05c1dd1cd9"
                    },
                    {
                      "option": "Cancel",
                      "step_iri": "/api/3/workflow_steps/08934d78-cb8a-4d76-b4fe-e254a92974f7"
                    }
                  ],
                  "duplicateOption": false
                }
              },
              "status": null,
              "left": "640",
              "top": "460",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "021810d4-eb14-4003-8252-759612eec49c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Targeted File Name not entered",
              "description": null,
              "arguments": {
                "resource": {
                  "alerts": "{{vars.input.records[0]['@id']}}",
                  "content": "Targeted File Name is important for the investigation, since it couldn't be provided at the playbook execution time, identify it and add it to the alert",
                  "__replace": "",
                  "rawCommentData": "Targeted File Name is important for the investigation, since **it couldn't be provided** at the playbook execution time, identify it and add it to the alert"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "640",
              "top": "333",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "08934d78-cb8a-4d76-b4fe-e254a92974f7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Indicator",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Create Indicator **{{vars.source_ip}}**",
                  "records": ""
                },
                "resource": {
                  "value": "{{vars.source_ip}}",
                  "sources": "SIEM",
                  "__replace": "true",
                  "firstSeen": "{{vars.incident_first_seen}}",
                  "reputation": {
                    "id": 109,
                    "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#c42323",
                    "display": "Malicious",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Malicious",
                    "orderIndex": 1
                  },
                  "description": "VirusTotal.com Score: **{{vars.steps.Get_Attacker_IP_Reputation_VT.data.aggregate}}**",
                  "indicatorStatus": {
                    "id": 366,
                    "@id": "/api/3/picklists/fa29fe48-f01e-476f-bb33-c910f5795b57",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Blocked",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "Blocked",
                    "orderIndex": 0
                  },
                  "typeofindicator": {
                    "id": 77,
                    "@id": "/api/3/picklists/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "IP Address",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "IP Address",
                    "orderIndex": 7
                  },
                  "vulnerabilities": "{{vars.steps.Record_Vulnerabilities['@id']}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "980",
              "top": "432",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "0bad59c9-b33f-483d-a213-fb05c1dd1cd9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Initial Alert Update",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "content": "Updating Alert Details",
                  "records": ""
                },
                "resource": {
                  "url": "{{vars.input.records[0].sourcedata.associated_events.event_details[0][0].attributes.uriStem}}",
                  "name": "{{vars.incident_source_data.attributes.eventName}}-{{vars.incident_source_data.attributes.incidentId}}",
                  "type": {
                    "id": 124,
                    "@id": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Other / Unknown",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "Other / Unknown",
                    "orderIndex": 13
                  },
                  "dueBy": "{{globalVars.Current_Data}}",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "domain": "fortielab.com",
                  "status": {
                    "id": 118,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "ackDate": "{{globalVars.Current_Date}}",
                  "severity": {
                    "id": 177,
                    "@id": "/api/3/picklists/b3c20a3a-ecfd-4adc-a225-0205968e6793",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#D2AC1A",
                    "display": "Medium",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Medium",
                    "orderIndex": 2
                  },
                  "sourceIp": "{%if vars.incident_source_data.attributes.srcIpAddr%}{{vars.incident_source_data.attributes.srcIpAddr}}{%endif%}",
                  "assignedTo": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
                  "sourceType": "SIEM",
                  "sourcedata": "{{vars.incident_source_data|toJSON}}",
                  "description": "#### Description:\n> {{vars.incident_source_data.attributes.incidentTitle}}\n> {%if vars.incident_source_data.attributes.srcIpAddr%}Source IP:{{vars.incident_source_data.attributes.srcIpAddr}}{%endif%}<br />{%if vars.incident_source_data.attributes.destIpAddr%}Destination IP:&nbsp;{{vars.incident_source_data.attributes.destIpAddr}}{%endif%}\n<a href='https://fortiguard.com/encyclopedia/ips/{{vars.incident_attack_id}}/{{vars.incident_attack_name}}'>Click Here for the Attack Details on Fortiguard.com</a>\n#### Source location\n> {{vars.steps.Get_Attacker_IP_Information.data['asn_country_code']}}-{{vars.steps.Get_Attacker_IP_Information.data['asn_description']}}\n#### Targeted File:\n> uriStem:{{vars.input.records[0].sourcedata.associated_events.event_details[0][0].attributes.uriStem}}",
                  "destinationIp": "{%if vars.incident_source_data.attributes.destIpAddr%}{{vars.incident_source_data.attributes.destIpAddr}}{%endif%}",
                  "sourceProcess": "httpd",
                  "killChainPhase": {
                    "id": 376,
                    "@id": "/api/3/picklists/1713c4c8-7e66-4bb9-bf46-096a9e2bc071",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Exploitation",
                    "listName": "/api/3/picklist_names/eddbc863-c725-479a-867f-cec66206a6b4",
                    "itemValue": "Exploitation",
                    "orderIndex": 4
                  },
                  "escalatedtoincident": {
                    "id": 31,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "left": "640",
              "top": "668",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "772ec0a5-b0f4-4532-a9eb-8503e6a21842"
            },
            {
              "@type": "WorkflowStep",
              "name": "Email Approved",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/b4e66339-f021-40d0-b310-66b33eb2f77c",
                    "condition": "{{ vars.steps.Email_Notification_to_ISP.approved }}"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/e6d0ab3b-eea2-4182-8f69-d27ed7c3e817"
                  }
                ]
              },
              "status": null,
              "left": "1327",
              "top": "140",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "2caa30da-83e7-4f05-9777-6b73aaf94da3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Not Send the Email",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.0.2",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "left": "1327",
              "top": "260",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "e6d0ab3b-eea2-4182-8f69-d27ed7c3e817"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "8b201f9a-d0e7-4ae9-93f5-199912b67379",
              "name": "Find Vulnerability -> Vulnerability Exists",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/8f33b557-f91f-4c51-aec3-5291467cace3",
              "sourceStep": "/api/3/workflow_steps/1fd62fc3-e4bd-4401-8de9-9e653bb135fa"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "4ee93047-d880-4e52-b5ee-2f2ec28d779d",
              "name": "Vulnerability Exists -> Assess Vulnerabilities",
              "label": "no",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/7c0b1a3a-167b-489a-9451-7f4a736618ea",
              "sourceStep": "/api/3/workflow_steps/8f33b557-f91f-4c51-aec3-5291467cace3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "5a872267-822c-4444-930c-922a2c577af8",
              "name": "Update Alert -> Check if server vulnerable to the Attack",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/6ba453c4-b2ff-4d9c-b728-94234edc7b98",
              "sourceStep": "/api/3/workflow_steps/a17cecaa-9497-4996-94c1-7cd640befa60"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3e0c6a91-2c30-430f-9763-b655d3986033",
              "name": "Vulnerability Exists -> Delete Previous Vulnerabilities",
              "label": "yes",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/aac8d116-7f69-422b-b606-69064a754e88",
              "sourceStep": "/api/3/workflow_steps/8f33b557-f91f-4c51-aec3-5291467cace3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "24e5348d-74ca-48fa-a147-6286899929b9",
              "name": "Delete Previous Vulnerabilities -> Record Vulnerabilities",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/7c0b1a3a-167b-489a-9451-7f4a736618ea",
              "sourceStep": "/api/3/workflow_steps/aac8d116-7f69-422b-b606-69064a754e88"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "52e3296c-1583-498f-ac34-06b50ead4cbd",
              "name": "ISP Contact present -> Email Notification to ISP",
              "label": "yes",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/f48e815d-9e1a-4556-8d8f-2decc9fdaf5f",
              "sourceStep": "/api/3/workflow_steps/bf35a32b-37cf-458e-bb85-5a18aa36abc3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "6201ccd7-3f37-4b01-8d3b-7e30064c4b32",
              "name": "ISP Contact Exists -> Do Nothing",
              "label": "no",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/9993c966-adbf-4c1b-af3d-22e54989405a",
              "sourceStep": "/api/3/workflow_steps/bf35a32b-37cf-458e-bb85-5a18aa36abc3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "c8c53148-5377-4f49-91a1-a18963c72671",
              "name": "Get Attacker IP Information -> Get Attacker IP Reputation VT",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/1b38e1d9-39f8-4663-a95e-f7efaa6276d9",
              "sourceStep": "/api/3/workflow_steps/fa4626e0-9b29-4783-b4d6-c83947fb4219"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "529e81c9-fb6f-4daf-b4ea-117c22b38942",
              "name": "Get Attacker IP Reputation VT -> Find Vulnerability",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/1fd62fc3-e4bd-4401-8de9-9e653bb135fa",
              "sourceStep": "/api/3/workflow_steps/1b38e1d9-39f8-4663-a95e-f7efaa6276d9"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "d1757964-126e-4567-ad06-f855d52dedd9",
              "name": "Create WebServer Asset -> Identify Targeted File",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/021810d4-eb14-4003-8252-759612eec49c",
              "sourceStep": "/api/3/workflow_steps/00051be5-76e8-4be5-a817-4794d17f9e98"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "43e4c12c-11b1-43f3-b1e4-7187079d46f0",
              "name": "Identify Targeted File -> Targeted File Name not entered",
              "label": "Cancel",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/08934d78-cb8a-4d76-b4fe-e254a92974f7",
              "sourceStep": "/api/3/workflow_steps/021810d4-eb14-4003-8252-759612eec49c"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "0508774f-722f-4204-9f9a-635b9eee2d10",
              "name": "Create Indicator -> Update Alert",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/a17cecaa-9497-4996-94c1-7cd640befa60",
              "sourceStep": "/api/3/workflow_steps/0bad59c9-b33f-483d-a213-fb05c1dd1cd9"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "d568787d-c119-4161-85a0-5c3e4fceeb77",
              "name": "Record Vulnerabilities -> Initial Alert Update",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/772ec0a5-b0f4-4532-a9eb-8503e6a21842",
              "sourceStep": "/api/3/workflow_steps/7c0b1a3a-167b-489a-9451-7f4a736618ea"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "25215300-2d59-4134-a58f-f5e7b0f4c08b",
              "name": "Initial Alert Update -> Create WebServer Asset",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/00051be5-76e8-4be5-a817-4794d17f9e98",
              "sourceStep": "/api/3/workflow_steps/772ec0a5-b0f4-4532-a9eb-8503e6a21842"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "3c8bc141-5d87-4c6e-8585-99ac8112c283",
              "name": "Identify Targeted File -> Create Indicator",
              "label": "Ok",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/0bad59c9-b33f-483d-a213-fb05c1dd1cd9",
              "sourceStep": "/api/3/workflow_steps/021810d4-eb14-4003-8252-759612eec49c"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "7510984f-9bf7-43c8-82a1-81669c0b7660",
              "name": "Targeted File Name not entered -> Create Indicator",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/0bad59c9-b33f-483d-a213-fb05c1dd1cd9",
              "sourceStep": "/api/3/workflow_steps/08934d78-cb8a-4d76-b4fe-e254a92974f7"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "e7e8d5e7-c2e3-4549-9681-0a65de0341c3",
              "name": "Start -> Configuration",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/a8aaac05-6c4e-4206-ab84-5f165c7f60be",
              "sourceStep": "/api/3/workflow_steps/7e89cb0d-65c2-4dab-a495-937478e53f63"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "44f77c2d-7016-41f6-a3c3-6f299d544390",
              "name": "Configuration -> Get Attacker IP Information",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/fa4626e0-9b29-4783-b4d6-c83947fb4219",
              "sourceStep": "/api/3/workflow_steps/a8aaac05-6c4e-4206-ab84-5f165c7f60be"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "7b1f0755-b848-45ff-8d70-9bedcea9b7f5",
              "name": "Get Attacker IP Information -> ISP Contact Exists",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/bf35a32b-37cf-458e-bb85-5a18aa36abc3",
              "sourceStep": "/api/3/workflow_steps/fa4626e0-9b29-4783-b4d6-c83947fb4219"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "ea0885e0-7bbe-4b97-8ce5-bdb199bb05eb",
              "name": "Email Notification to ISP -> Email Approved",
              "label": null,
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/2caa30da-83e7-4f05-9777-6b73aaf94da3",
              "sourceStep": "/api/3/workflow_steps/f48e815d-9e1a-4556-8d8f-2decc9fdaf5f"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "2348d876-2ba6-4dee-a920-3fcda96ecf76",
              "name": "Email Approved -> Send Email to ISP",
              "label": "yes",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/b4e66339-f021-40d0-b310-66b33eb2f77c",
              "sourceStep": "/api/3/workflow_steps/2caa30da-83e7-4f05-9777-6b73aaf94da3"
            },
            {
              "@type": "WorkflowRoute",
              "uuid": "ba3c54f7-5661-4e5f-95ac-75c2e77affe9",
              "name": "Email Approved -> Do Not Send the Email",
              "label": "no",
              "isExecuted": false,
              "targetStep": "/api/3/workflow_steps/e6d0ab3b-eea2-4182-8f69-d27ed7c3e817",
              "sourceStep": "/api/3/workflow_steps/2caa30da-83e7-4f05-9777-6b73aaf94da3"
            }
          ],
          "versions": null,
          "lastModifyDate": 1590776340,
          "uuid": "df538bef-a008-4137-91f3-0505bcb6d1f6",
          "recordTags": [],
          "isPrivate": false,
          "owners": []
        }
      ],
      "uuid": "fc4bddca-9896-432e-b2c2-e9dc4f0d1bb2",
      "recordTags": []
    }
  ],
  "macros": [
    {
      "name": "Current_Data",
      "value": "{{vars.input.records[0]}}",
      "default_value": null
    },
    {
      "name": "Current_Date",
      "value": "{{arrow.utcnow().timestamp}}",
      "default_value": null
    }
  ],
  "exported_tags": []
}