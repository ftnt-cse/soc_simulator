<html>
<head>

<style>

  body {
    font-family: arial;
  }
 
  table, th, td {
    padding: 10px;
    border: 1px solid;
    border-collapse: collapse;
  }

</style>

</head>
</body>

<?php
  // GET VARS FROM REFERRING PAGE
  $step = $_POST['step'];
  $scenarioFilePath = $_POST['scenarioFilePath'];


?>

<h2>Edit Step <?php echo $step + 1; ?></h2>


<?php

  // OPEN SCENARIO FILE AND READ STEP

    $scenarioFile = fopen("$scenarioFilePath", "r");
    $currentScenario = json_decode(fread($scenarioFile, filesize("../simulator/scenarios/my_scenarios/MyScenario/myscenario.json")), true);
    fclose($scenarioFile);

?>

<form method="post" action="save_step.php">

<table>
  <tr>
    <th>Attribute</th>
    <th>Existing Value</th>
    <th>New Value</th>
  </tr>

<?php		// BUILD ATTRIBUTE TABLE

foreach ($currentScenario[$step][data][0][sourcedata][incident] as $key => $i) {
?>
  <tr>
     <td><label for="<?php echo $key; ?>"><?php echo $key; ?></label></td>
     <td><?php echo $i; ?></td>
     <td><input type="text" id="<?php echo $key; ?>" name="<?php echo $key; ?>" value="<?php echo $i; ?>"</td>
   </tr>

<?php
}

?>

  <tr>
    <td colspan="3">
      <input type="hidden" name="save" value="save">
      <!-- send $step and $scenariofilePath on when form is resubmitted -->
      <input type="hidden" name="scenarioFilePath" value="<?php echo $scenarioFilePath; ?>">
      <input type="hidden" name="step" value="<?php echo $step; ?>">
      <input type="submit" name="submit" value="Save">
    </td>
  </tr>
</table>

</form>

</body>
<html>
